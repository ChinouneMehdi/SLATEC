!** DLNREL
REAL(8) FUNCTION DLNREL(X)
  !>
  !  Evaluate ln(1+X) accurate in the sense of relative error.
  !***
  ! **Library:**   SLATEC (FNLIB)
  !***
  ! **Category:**  C4B
  !***
  ! **Type:**      DOUBLE PRECISION (ALNREL-S, DLNREL-D, CLNREL-C)
  !***
  ! **Keywords:**  ELEMENTARY FUNCTIONS, FNLIB, LOGARITHM
  !***
  ! **Author:**  Fullerton, W., (LANL)
  !***
  ! **Description:**
  !
  ! DLNREL(X) calculates the double precision natural logarithm of
  ! (1.0+X) for double precision argument X.  This routine should
  ! be used when X is small and accurate to calculate the logarithm
  ! accurately (in the relative error sense) in the neighborhood
  ! of 1.0.
  !
  ! Series for ALNR       on the interval -3.75000E-01 to  3.75000E-01
  !                                        with weighted error   6.35E-32
  !                                         log weighted error  31.20
  !                               significant figures required  30.93
  !                                    decimal places required  32.01
  !
  !***
  ! **References:**  (NONE)
  !***
  ! **Routines called:**  D1MACH, DCSEVL, INITDS, XERMSG

  !* REVISION HISTORY  (YYMMDD)
  !   770601  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   890531  REVISION DATE from Version 3.2
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
  USE service, ONLY : XERMSG, D1MACH
  REAL(8) :: X
  INTEGER, SAVE :: nlnrel
  REAL(8), SAVE :: xmin
  REAL(8), PARAMETER :: alnrcs(43) = [ +.10378693562743769800686267719098D+1, &
    -.13364301504908918098766041553133D+0, +.19408249135520563357926199374750D-1, &
    -.30107551127535777690376537776592D-2, +.48694614797154850090456366509137D-3, &
    -.81054881893175356066809943008622D-4, +.13778847799559524782938251496059D-4, &
    -.23802210894358970251369992914935D-5, +.41640416213865183476391859901989D-6, &
    -.73595828378075994984266837031998D-7, +.13117611876241674949152294345011D-7, &
    -.23546709317742425136696092330175D-8, +.42522773276034997775638052962567D-9, &
    -.77190894134840796826108107493300D-10, +.14075746481359069909215356472191D-10, &
    -.25769072058024680627537078627584D-11, +.47342406666294421849154395005938D-12, &
    -.87249012674742641745301263292675D-13, +.16124614902740551465739833119115D-13, &
    -.29875652015665773006710792416815D-14, +.55480701209082887983041321697279D-15, &
    -.10324619158271569595141333961932D-15, +.19250239203049851177878503244868D-16, &
    -.35955073465265150011189707844266D-17, +.67264542537876857892194574226773D-18, &
    -.12602624168735219252082425637546D-18, +.23644884408606210044916158955519D-19, &
    -.44419377050807936898878389179733D-20, +.83546594464034259016241293994666D-21, &
    -.15731559416479562574899253521066D-21, +.29653128740247422686154369706666D-22, &
    -.55949583481815947292156013226666D-23, +.10566354268835681048187284138666D-23, &
    -.19972483680670204548314999466666D-24, +.37782977818839361421049855999999D-25, &
    -.71531586889081740345038165333333D-26, +.13552488463674213646502024533333D-26, &
    -.25694673048487567430079829333333D-27, +.48747756066216949076459519999999D-28, &
    -.92542112530849715321132373333333D-29, +.17578597841760239233269760000000D-29, &
    -.33410026677731010351377066666666D-30, +.63533936180236187354180266666666D-31 ]
  LOGICAL :: first = .TRUE.
  !* FIRST EXECUTABLE STATEMENT  DLNREL
  IF ( first ) THEN
    nlnrel = INITDS(alnrcs,43,0.1*REAL(D1MACH(3)))
    xmin = -1.0D0 + SQRT(D1MACH(4))
    first = .FALSE.
  END IF
  !
  IF ( X<=(-1.D0) ) CALL XERMSG('SLATEC','DLNREL','X IS LE -1',2,2)
  IF ( X<xmin ) CALL XERMSG('SLATEC','DLNREL',&
    'ANSWER LT HALF PRECISION BECAUSE X TOO NEAR -1',1,1)
  !
  IF ( ABS(X)<=0.375D0 ) THEN
    DLNREL = X*(1.D0-X*DCSEVL(X/.375D0,alnrcs,nlnrel))
  ELSE
    DLNREL = LOG(1.0D0+X)
  END IF
  !
END FUNCTION DLNREL
