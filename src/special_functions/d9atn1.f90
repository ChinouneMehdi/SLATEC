!** D9ATN1
REAL(DP) FUNCTION D9ATN1(X)
  !> Evaluate ATAN(X) from first order relative accuracy so
  !            that ATAN(X) = X + X**3*D9ATN1(X).
  !***
  ! **Library:**   SLATEC (FNLIB)
  !***
  ! **Category:**  C4A
  !***
  ! **Type:**      DOUBLE PRECISION (R9ATN1-S, D9ATN1-D)
  !***
  ! **Keywords:**  ARC TANGENT, ELEMENTARY FUNCTIONS, FIRST ORDER, FNLIB,
  !             TRIGONOMETRIC
  !***
  ! **Author:**  Fullerton, W., (LANL)
  !***
  ! **Description:**
  !
  ! Evaluate  ATAN(X)  from first order, that is, evaluate
  ! (ATAN(X)-X)/X**3  with relative error accuracy so that
  !        ATAN(X) = X + X**3*D9ATN1(X).
  !
  ! Series for ATN1       on the interval  0.          to  1.00000E+00
  !                                        with weighted error   3.39E-32
  !                                         log weighted error  31.47
  !                               significant figures required  30.26
  !                                    decimal places required  32.27
  !
  !***
  ! **References:**  (NONE)
  !***
  ! **Routines called:**  D1MACH, DCSEVL, INITDS, XERMSG

  !* REVISION HISTORY  (YYMMDD)
  !   780401  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   891115  Corrected third argument in reference to INITDS.  (WRB)
  !   891115  REVISION DATE from Version 3.2
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
  !   900720  Routine changed from user-callable to subsidiary.  (WRB)
  USE service, ONLY : XERMSG, D1MACH
  REAL(DP) :: X
  REAL(DP) :: y
  INTEGER, SAVE :: ntatn1
  REAL(DP), PARAMETER :: eps = D1MACH(3), xsml = SQRT(0.1_DP*eps), &
    xbig = 1.571_DP/SQRT(eps), xmax = 1.571_DP/eps
  REAL(DP), PARAMETER :: atn1cs(40) = [ -.3283997535355202356907939922990E-1_DP, &
    +.5833432343172412449951669914907E-1_DP, -.7400369696719646463809011551413E-2_DP, &
    +.1009784199337288083590357511639E-2_DP, -.1439787163565205621471303697700E-3_DP, &
    +.2114512648992107572072112243439E-4_DP, -.3172321074254667167402564996757E-5_DP, &
    +.4836620365460710825377859384800E-6_DP, -.7467746546814112670437614322776E-7_DP, &
    +.1164800896824429830620998641342E-7_DP, -.1832088370847201392699956242452E-8_DP, &
    +.2901908277966063313175351230455E-9_DP, -.4623885312106326738351805721512E-10_DP, &
    +.7405528668775736917992197048286E-11_DP, -.1191354457845136682370820373417E-11_DP, &
    +.1924090144391772599867855692518E-12_DP, -.3118271051076194272254476155327E-13_DP, &
    +.5069240036567731789694520593032E-14_DP, -.8263694719802866053818284405964E-15_DP, &
    +.1350486709817079420526506123029E-15_DP, -.2212023650481746045840137823191E-16_DP, &
    +.3630654747381356783829047647709E-17_DP, -.5970345328847154052451215859165E-18_DP, &
    +.9834816050077133119448329005738E-19_DP, -.1622655075855062336144387604480E-19_DP, &
    +.2681186176945436796301320301226E-20_DP, -.4436309706785255479636243688106E-21_DP, &
    +.7349691897652496945072465510400E-22_DP, -.1219077508350052588289401378133E-22_DP, &
    +.2024298836805215403184540876799E-23_DP, -.3364871555797354579925576362666E-24_DP, &
    +.5598673968346988749492933973333E-25_DP, -.9323939267272320229628532053333E-26_DP, &
    +.1554133116995970222934807893333E-26_DP, -.2592569534179745922757427199999E-27_DP, &
    +.4328193466245734685037909333333E-28_DP, -.7231013125595437471192405333333E-29_DP, &
    +.1208902859830494772942165333333E-29_DP, -.2022404543449897579315199999999E-30_DP, &
    +.3385428713046493843073706666666E-31_DP ]
  LOGICAL, SAVE :: first = .TRUE.
  !* FIRST EXECUTABLE STATEMENT  D9ATN1
  IF( first ) THEN
    ntatn1 = INITDS(atn1cs,40,0.1_DP*eps)
    first = .FALSE.
  END IF
  !
  y = ABS(X)
  IF( y>1._DP ) THEN
    !
    IF( y>xmax ) CALL XERMSG('D9ATN1',&
      'NO PRECISION IN ANSWER BECAUSE X IS TOO BIG',2,2)
    IF( y>xbig ) CALL XERMSG('D9ATN1',&
      'ANSWER LT HALF PRECISION BECAUSE X IS TOO BIG',1,1)
    !
    D9ATN1 = (ATAN(X)-X)/X**3
    RETURN
  END IF
  !
  IF( y<=xsml ) D9ATN1 = -1._DP/3._DP
  IF( y<=xsml ) RETURN
  !
  D9ATN1 = -0.25_DP + DCSEVL(2._DP*y*y-1._DP,atn1cs,ntatn1)
  RETURN
END FUNCTION D9ATN1
