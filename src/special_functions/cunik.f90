!** CUNIK
PURE SUBROUTINE CUNIK(Zr,Fnu,Ikflg,Ipmtr,Tol,Init,Phi,Zeta1,Zeta2,Summ,Cwrk)
  !> Subsidiary to CBESI and CBESK
  !***
  ! **Library:**   SLATEC
  !***
  ! **Type:**      ALL (CUNIK-A, ZUNIK-A)
  !***
  ! **Author:**  Amos, D. E., (SNL)
  !***
  ! **Description:**
  !
  !        CUNIK COMPUTES PARAMETERS FOR THE UNIFORM ASYMPTOTIC
  !        EXPANSIONS OF THE I AND K FUNCTIONS ON IKFLG= 1 OR 2
  !        RESPECTIVELY BY
  !
  !        W(FNU,ZR) = PHI*EXP(ZETA)*SUM
  !
  !        WHERE       ZETA=-ZETA1 + ZETA2       OR
  !                          ZETA1 - ZETA2
  !
  !        THE FIRST CALL MUST HAVE INIT=0. SUBSEQUENT CALLS WITH THE
  !        SAME ZR AND FNU WILL RETURN THE I OR K FUNCTION ON IKFLG=
  !        1 OR 2 WITH NO CHANGE IN INIT. CWRK IS A COMPLEX WORK
  !        ARRAY. IPMTR=0 COMPUTES ALL PARAMETERS. IPMTR=1 COMPUTES PHI,
  !        ZETA1,ZETA2.
  !
  !***
  ! **See also:**  CBESI, CBESK
  !***
  ! **Routines called:**  R1MACH

  !* REVISION HISTORY  (YYMMDD)
  !   830501  DATE WRITTEN
  !   910415  Prologue converted to Version 4.0 format.  (BAB)
  USE service, ONLY : R1MACH
  INTEGER, INTENT(IN) :: Ikflg, Ipmtr
  INTEGER, INTENT(INOUT) :: Init
  REAL(SP), INTENT(IN) :: Fnu, Tol
  COMPLEX(SP), INTENT(IN) :: Zr
  COMPLEX(SP), INTENT(OUT) :: Phi, Summ, Zeta1, Zeta2, Cwrk(16)
  INTEGER :: i, j, k, l
  REAL(SP) :: ac, rfn, test, tstr, tsti
  COMPLEX(SP) :: cfn, crfn, s, sr, t, t2, zn
  COMPLEX(SP), PARAMETER :: czero = (0._SP,0._SP), cone = (1._SP,0._SP)
  COMPLEX(SP), PARAMETER :: con(2) = [ (3.98942280401432678E-01_SP,0._SP), &
    (1.25331413731550025E+00_SP,0._SP) ]
  REAL(SP), PARAMETER :: c(120) = [ 1.00000000000000000E+00_SP, -2.08333333333333333E-01_SP, &
    1.25000000000000000E-01_SP, 3.34201388888888889E-01_SP, -4.01041666666666667E-01_SP, &
    7.03125000000000000E-02_SP, -1.02581259645061728E+00_SP, 1.84646267361111111E+00_SP, &
    -8.91210937500000000E-01_SP, 7.32421875000000000E-02_SP, 4.66958442342624743E+00_SP, &
    -1.12070026162229938E+01_SP, 8.78912353515625000E+00_SP, -2.36408691406250000E+00_SP, &
    1.12152099609375000E-01_SP, -2.82120725582002449E+01_SP, 8.46362176746007346E+01_SP, &
    -9.18182415432400174E+01_SP, 4.25349987453884549E+01_SP, -7.36879435947963170E+00_SP, &
    2.27108001708984375E-01_SP, 2.12570130039217123E+02_SP, -7.65252468141181642E+02_SP, &
    1.05999045252799988E+03_SP, -6.99579627376132541E+02_SP, 2.18190511744211590E+02_SP, &
    -2.64914304869515555E+01_SP, 5.72501420974731445E-01_SP, -1.91945766231840700E+03_SP, &
    8.06172218173730938E+03_SP, -1.35865500064341374E+04_SP, 1.16553933368645332E+04_SP, &
    -5.30564697861340311E+03_SP, 1.20090291321635246E+03_SP, -1.08090919788394656E+02_SP, &
    1.72772750258445740E+00_SP, 2.02042913309661486E+04_SP, -9.69805983886375135E+04_SP, &
    1.92547001232531532E+05_SP, -2.03400177280415534E+05_SP, 1.22200464983017460E+05_SP, &
    -4.11926549688975513E+04_SP, 7.10951430248936372E+03_SP, -4.93915304773088012E+02_SP, &
    6.07404200127348304E+00_SP, -2.42919187900551333E+05_SP, 1.31176361466297720E+06_SP, &
    -2.99801591853810675E+06_SP, 3.76327129765640400E+06_SP, -2.81356322658653411E+06_SP, &
    1.26836527332162478E+06_SP, -3.31645172484563578E+05_SP, 4.52187689813627263E+04_SP, &
    -2.49983048181120962E+03_SP, 2.43805296995560639E+01_SP, 3.28446985307203782E+06_SP, &
    -1.97068191184322269E+07_SP, 5.09526024926646422E+07_SP, -7.41051482115326577E+07_SP, &
    6.63445122747290267E+07_SP, -3.75671766607633513E+07_SP, 1.32887671664218183E+07_SP, &
    -2.78561812808645469E+06_SP, 3.08186404612662398E+05_SP, -1.38860897537170405E+04_SP, &
    1.10017140269246738E+02_SP, -4.93292536645099620E+07_SP, 3.25573074185765749E+08_SP, &
    -9.39462359681578403E+08_SP, 1.55359689957058006E+09_SP, -1.62108055210833708E+09_SP, &
    1.10684281682301447E+09_SP, -4.95889784275030309E+08_SP, 1.42062907797533095E+08_SP, &
    -2.44740627257387285E+07_SP, 2.24376817792244943E+06_SP, -8.40054336030240853E+04_SP, &
    5.51335896122020586E+02_SP, 8.14789096118312115E+08_SP, -5.86648149205184723E+09_SP, &
    1.86882075092958249E+10_SP, -3.46320433881587779E+10_SP, 4.12801855797539740E+10_SP, &
    -3.30265997498007231E+10_SP, 1.79542137311556001E+10_SP, -6.56329379261928433E+09_SP, &
    1.55927986487925751E+09_SP, -2.25105661889415278E+08_SP, 1.73951075539781645E+07_SP, &
    -5.49842327572288687E+05_SP, 3.03809051092238427E+03_SP, -1.46792612476956167E+10_SP, &
    1.14498237732025810E+11_SP, -3.99096175224466498E+11_SP, 8.19218669548577329E+11_SP, &
    -1.09837515608122331E+12_SP, 1.00815810686538209E+12_SP, -6.45364869245376503E+11_SP, &
    2.87900649906150589E+11_SP, -8.78670721780232657E+10_SP, 1.76347306068349694E+10_SP, &
    -2.16716498322379509E+09_SP, 1.43157876718888981E+08_SP, -3.87183344257261262E+06_SP, &
    1.82577554742931747E+04_SP, 2.86464035717679043E+11_SP, -2.40629790002850396E+12_SP, &
    9.10934118523989896E+12_SP, -2.05168994109344374E+13_SP, 3.05651255199353206E+13_SP, &
    -3.16670885847851584E+13_SP, 2.33483640445818409E+13_SP, -1.23204913055982872E+13_SP, &
    4.61272578084913197E+12_SP, -1.19655288019618160E+12_SP, 2.05914503232410016E+11_SP, &
    -2.18229277575292237E+10_SP, 1.24700929351271032E+09_SP, -2.91883881222208134E+07_SP, &
    1.18838426256783253E+05_SP ]
  !* FIRST EXECUTABLE STATEMENT  CUNIK
  IF( Init==0 ) THEN
    !-----------------------------------------------------------------------
    !     INITIALIZE ALL VARIABLES
    !-----------------------------------------------------------------------
    rfn = 1._SP/Fnu
    crfn = CMPLX(rfn,0._SP,SP)
    !     T = ZR*CRFN
    !-----------------------------------------------------------------------
    !     OVERFLOW TEST (ZR/FNU TOO SMALL)
    !-----------------------------------------------------------------------
    tstr = REAL(Zr)
    tsti = AIMAG(Zr)
    test = R1MACH(1)*1.E+3_SP
    ac = Fnu*test
    IF( ABS(tstr)>ac .OR. ABS(tsti)>ac ) THEN
      t = Zr*crfn
      s = cone + t*t
      sr = SQRT(s)
      cfn = CMPLX(Fnu,0._SP,SP)
      zn = (cone+sr)/t
      Zeta1 = cfn*LOG(zn)
      Zeta2 = cfn*sr
      t = cone/sr
      sr = t*crfn
      Cwrk(16) = SQRT(sr)
      Phi = Cwrk(16)*con(Ikflg)
      IF( Ipmtr/=0 ) RETURN
      t2 = cone/s
      Cwrk(1) = cone
      crfn = cone
      ac = 1._SP
      l = 1
      DO k = 2, 15
        s = czero
        DO j = 1, k
          l = l + 1
          s = s*t2 + CMPLX(c(l),0._SP,SP)
        END DO
        crfn = crfn*sr
        Cwrk(k) = crfn*s
        ac = ac*rfn
        tstr = REAL(Cwrk(k))
        tsti = AIMAG(Cwrk(k))
        test = ABS(tstr) + ABS(tsti)
        IF( ac<Tol .AND. test<Tol ) GOTO 20
      END DO
      k = 15
      20  Init = k
    ELSE
      ac = 2._SP*ABS(LOG(test)) + Fnu
      Zeta1 = CMPLX(ac,0._SP,SP)
      Zeta2 = CMPLX(Fnu,0._SP,SP)
      Phi = cone
      RETURN
    END IF
  END IF
  IF( Ikflg==2 ) THEN
    !-----------------------------------------------------------------------
    !     COMPUTE SUM FOR THE K FUNCTION
    !-----------------------------------------------------------------------
    s = czero
    t = cone
    DO i = 1, Init
      s = s + t*Cwrk(i)
      t = -t
    END DO
    Summ = s
    Phi = Cwrk(16)*con(2)
    RETURN
  END IF
  !-----------------------------------------------------------------------
  !     COMPUTE SUM FOR THE I FUNCTION
  !-----------------------------------------------------------------------
  s = czero
  DO i = 1, Init
    s = s + Cwrk(i)
  END DO
  Summ = s
  Phi = Cwrk(16)*con(1)

  RETURN
END SUBROUTINE CUNIK