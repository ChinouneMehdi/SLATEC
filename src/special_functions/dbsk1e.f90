!** DBSK1E
REAL(DP) ELEMENTAL FUNCTION DBSK1E(X)
  !> Compute the exponentially scaled modified (hyperbolic)
  !  Bessel function of the third kind of order one.
  !***
  ! **Library:**   SLATEC (FNLIB)
  !***
  ! **Category:**  C10B1
  !***
  ! **Type:**      DOUBLE PRECISION (BESK1E-S, DBSK1E-D)
  !***
  ! **Keywords:**  EXPONENTIALLY SCALED, FNLIB, HYPERBOLIC BESSEL FUNCTION,
  !             MODIFIED BESSEL FUNCTION, ORDER ONE, SPECIAL FUNCTIONS, THIRD KIND
  !***
  ! **Author:**  Fullerton, W., (LANL)
  !***
  ! **Description:**
  !
  ! DBSK1E(S) computes the double precision exponentially scaled
  ! modified (hyperbolic) Bessel function of the third kind of order
  ! one for positive double precision argument X.
  !
  ! Series for BK1        on the interval  0.          to  4.00000E+00
  !                                        with weighted error   9.16E-32
  !                                         log weighted error  31.04
  !                               significant figures required  30.61
  !                                    decimal places required  31.64
  !
  ! Series for AK1        on the interval  1.25000E-01 to  5.00000E-01
  !                                        with weighted error   3.07E-32
  !                                         log weighted error  31.51
  !                               significant figures required  30.71
  !                                    decimal places required  32.30
  !
  ! Series for AK12       on the interval  0.          to  1.25000E-01
  !                                        with weighted error   2.41E-32
  !                                         log weighted error  31.62
  !                               significant figures required  30.25
  !                                    decimal places required  32.38
  !
  !***
  ! **References:**  (NONE)
  !***
  ! **Routines called:**  D1MACH, DBESI1, DCSEVL, INITDS, XERMSG

  !* REVISION HISTORY  (YYMMDD)
  !   770701  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   890531  REVISION DATE from Version 3.2
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
  USE service, ONLY : D1MACH
  REAL(DP), INTENT(IN) :: X
  REAL(DP) :: y
  INTEGER, PARAMETER :: ntk1 = 10, ntak1 = 18, ntak12 = 14
  REAL(DP), PARAMETER :: eta = 0.1_DP*D1MACH(3), xsml = SQRT(4._DP*D1MACH(3)), &
    xmin = EXP(MAX(LOG(D1MACH(1)),-LOG(D1MACH(2)))+0.01_DP)
  REAL(DP), PARAMETER :: bk1cs(16) = [ +.25300227338947770532531120868533E-1_DP, &
    -.35315596077654487566723831691801E+0_DP, -.12261118082265714823479067930042E+0_DP, &
    -.69757238596398643501812920296083E-2_DP, -.17302889575130520630176507368979E-3_DP, &
    -.24334061415659682349600735030164E-5_DP, -.22133876307347258558315252545126E-7_DP, &
    -.14114883926335277610958330212608E-9_DP, -.66669016941993290060853751264373E-12_DP, &
    -.24274498505193659339263196864853E-14_DP, -.70238634793862875971783797120000E-17_DP, &
    -.16543275155100994675491029333333E-19_DP, -.32338347459944491991893333333333E-22_DP, &
    -.53312750529265274999466666666666E-25_DP, -.75130407162157226666666666666666E-28_DP, &
    -.91550857176541866666666666666666E-31_DP ]
  REAL(DP), PARAMETER :: ak1cs(38) = [ +.27443134069738829695257666227266E+0_DP, &
    +.75719899531993678170892378149290E-1_DP, -.14410515564754061229853116175625E-2_DP, &
    +.66501169551257479394251385477036E-4_DP, -.43699847095201407660580845089167E-5_DP, &
    +.35402774997630526799417139008534E-6_DP, -.33111637792932920208982688245704E-7_DP, &
    +.34459775819010534532311499770992E-8_DP, -.38989323474754271048981937492758E-9_DP, &
    +.47208197504658356400947449339005E-10_DP, -.60478356628753562345373591562890E-11_DP, &
    +.81284948748658747888193837985663E-12_DP, -.11386945747147891428923915951042E-12_DP, &
    +.16540358408462282325972948205090E-13_DP, -.24809025677068848221516010440533E-14_DP, &
    +.38292378907024096948429227299157E-15_DP, -.60647341040012418187768210377386E-16_DP, &
    +.98324256232648616038194004650666E-17_DP, -.16284168738284380035666620115626E-17_DP, &
    +.27501536496752623718284120337066E-18_DP, -.47289666463953250924281069568000E-19_DP, &
    +.82681500028109932722392050346666E-20_DP, -.14681405136624956337193964885333E-20_DP, &
    +.26447639269208245978085894826666E-21_DP, -.48290157564856387897969868800000E-22_DP, &
    +.89293020743610130180656332799999E-23_DP, -.16708397168972517176997751466666E-23_DP, &
    +.31616456034040694931368618666666E-24_DP, -.60462055312274989106506410666666E-25_DP, &
    +.11678798942042732700718421333333E-25_DP, -.22773741582653996232867840000000E-26_DP, &
    +.44811097300773675795305813333333E-27_DP, -.88932884769020194062336000000000E-28_DP, &
    +.17794680018850275131392000000000E-28_DP, -.35884555967329095821994666666666E-29_DP, &
    +.72906290492694257991679999999999E-30_DP, -.14918449845546227073024000000000E-30_DP, &
    +.30736573872934276300799999999999E-31_DP ]
  REAL(DP), PARAMETER :: ak12cs(33) = [ +.6379308343739001036600488534102E-1_DP, &
    +.2832887813049720935835030284708E-1_DP, -.2475370673905250345414545566732E-3_DP, &
    +.5771972451607248820470976625763E-5_DP, -.2068939219536548302745533196552E-6_DP, &
    +.9739983441381804180309213097887E-8_DP, -.5585336140380624984688895511129E-9_DP, &
    +.3732996634046185240221212854731E-10_DP, -.2825051961023225445135065754928E-11_DP, &
    +.2372019002484144173643496955486E-12_DP, -.2176677387991753979268301667938E-13_DP, &
    +.2157914161616032453939562689706E-14_DP, -.2290196930718269275991551338154E-15_DP, &
    +.2582885729823274961919939565226E-16_DP, -.3076752641268463187621098173440E-17_DP, &
    +.3851487721280491597094896844799E-18_DP, -.5044794897641528977117282508800E-19_DP, &
    +.6888673850418544237018292223999E-20_DP, -.9775041541950118303002132480000E-21_DP, &
    +.1437416218523836461001659733333E-21_DP, -.2185059497344347373499733333333E-22_DP, &
    +.3426245621809220631645388800000E-23_DP, -.5531064394246408232501248000000E-24_DP, &
    +.9176601505685995403782826666666E-25_DP, -.1562287203618024911448746666666E-25_DP, &
    +.2725419375484333132349439999999E-26_DP, -.4865674910074827992378026666666E-27_DP, &
    +.8879388552723502587357866666666E-28_DP, -.1654585918039257548936533333333E-28_DP, &
    +.3145111321357848674303999999999E-29_DP, -.6092998312193127612416000000000E-30_DP, &
    +.1202021939369815834623999999999E-30_DP, -.2412930801459408841386666666666E-31_DP ]
  !* FIRST EXECUTABLE STATEMENT  DBSK1E
  ! ntk1 = INITDS(bk1cs,eta)
  ! ntak1 = INITDS(ak1cs,eta)
  ! ntak12 = INITDS(ak12cs,eta)
  !
  IF( X<=0._DP ) THEN
    ERROR STOP 'DBSK1E : X IS ZERO OR NEGATIVE'
  ELSEIF( X<xmin ) THEN
    ERROR STOP 'DBSK1E : X SO SMALL K1 OVERFLOWS'
  ELSEIF( X<=2._DP ) THEN
    y = 0._DP
    IF( X>xsml ) y = X*X
    DBSK1E = EXP(X) * ( LOG(0.5_DP*X)*DBESI1(X) &
      + (0.75_DP+DCSEVL(0.5_DP*y-1._DP,bk1cs(1:ntk1)))/X )
  ELSEIF( X<=8._DP ) THEN
    DBSK1E = (1.25_DP+DCSEVL((16._DP/X-5._DP)/3._DP,ak1cs(1:ntak1)))/SQRT(X)
  ELSE
    DBSK1E = (1.25_DP+DCSEVL(16._DP/X-1._DP,ak12cs(1:ntak12)))/SQRT(X)
  END IF

  RETURN
END FUNCTION DBSK1E