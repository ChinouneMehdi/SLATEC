!** ZUNHJ
SUBROUTINE ZUNHJ(Zr,Zi,Fnu,Ipmtr,Tol,Phir,Phii,Argr,Argi,Zeta1r,Zeta1i,&
    Zeta2r,Zeta2i,Asumr,Asumi,Bsumr,Bsumi)
  !> Subsidiary to ZBESI and ZBESK
  !***
  ! **Library:**   SLATEC
  !***
  ! **Type:**      ALL (CUNHJ-A, ZUNHJ-A)
  !***
  ! **Author:**  Amos, D. E., (SNL)
  !***
  ! **Description:**
  !
  !     REFERENCES
  !         HANDBOOK OF MATHEMATICAL FUNCTIONS BY M. ABRAMOWITZ AND I.A.
  !         STEGUN, AMS55, NATIONAL BUREAU OF STANDARDS, 1965, CHAPTER 9.
  !
  !         ASYMPTOTICS AND SPECIAL FUNCTIONS BY F.W.J. OLVER, ACADEMIC
  !         PRESS, N.Y., 1974, PAGE 420
  !
  !     ABSTRACT
  !         ZUNHJ COMPUTES PARAMETERS FOR BESSEL FUNCTIONS C(FNU,Z) =
  !         J(FNU,Z), Y(FNU,Z) OR H(I,FNU,Z) I=1,2 FOR LARGE ORDERS FNU
  !         BY MEANS OF THE UNIFORM ASYMPTOTIC EXPANSION
  !
  !         C(FNU,Z)=C1*PHI*( ASUM*AIRY(ARG) + C2*BSUM*DAIRY(ARG) )
  !
  !         FOR PROPER CHOICES OF C1, C2, AIRY AND DAIRY WHERE AIRY IS
  !         AN AIRY FUNCTION AND DAIRY IS ITS DERIVATIVE.
  !
  !               (2/3)*FNU*ZETA**1.5 = ZETA1-ZETA2,
  !
  !         ZETA1=0.5*FNU*LOG((1+W)/(1-W)), ZETA2=FNU*W FOR SCALING
  !         PURPOSES IN AIRY FUNCTIONS FROM CAIRY OR CBIRY.
  !
  !         MCONJ=SIGN OF AIMAG(Z), BUT IS AMBIGUOUS WHEN Z IS REAL AND
  !         MUST BE SPECIFIED. IPMTR=0 RETURNS ALL PARAMETERS. IPMTR=
  !         1 COMPUTES ALL EXCEPT ASUM AND BSUM.
  !
  !***
  ! **See also:**  ZBESI, ZBESK
  !***
  ! **Routines called:**  D1MACH, ZABS, ZDIV, ZLOG, ZSQRT

  !* REVISION HISTORY  (YYMMDD)
  !   830501  DATE WRITTEN
  !   910415  Prologue converted to Version 4.0 format.  (BAB)
  !   930122  Added ZLOG and ZSQRT to EXTERNAL statement.  (RWC)
  USE service, ONLY : D1MACH
  !     COMPLEX ARG,ASUM,BSUM,CFNU,CONE,CR,CZERO,DR,P,PHI,PRZTH,PTFN,
  !    *RFN13,RTZTA,RZTH,SUMA,SUMB,TFN,T2,UP,W,W2,Z,ZA,ZB,ZC,ZETA,ZETA1,
  !    *ZETA2,ZTH
  REAL(DP) :: ang, ap(30), Argi, Argr, Asumi, Asumr, atol, aw2, azth, Bsumi, Bsumr, &
    btol, cri(14), crr(14), dri(14), drr(14), Fnu, fn13, &
    fn23, Phii, Phir, pi(30), pp, pr(30), przthi, przthr, ptfni, ptfnr, &
    raw, raw2, razth, rfnu, rfnu2, rfn13, rtzti, rtztr, rzthi, rzthr, sti, str, &
    sumai, sumar, sumbi, sumbr, test, tfni, tfnr, Tol, tzai, tzar, t2i, &
    t2r, upi(14), upr(14), wi, wr, w2i, w2r, zai, zar, zbi, zbr, zci, zcr, &
    zetai, zetar, Zeta1i, Zeta1r, Zeta2i, Zeta2r, Zi, Zr, zthi, zthr, ac
  INTEGER :: ias, ibs, Ipmtr, is, j, jr, ju, k, kmax, kp1, ks, l, &
    lr, lrp1, l1, l2, m
  REAL(DP), PARAMETER :: ar(14) = [ 1.00000000000000000E+00_DP, 1.04166666666666667E-01_DP, &
    8.35503472222222222E-02_DP, 1.28226574556327160E-01_DP, 2.91849026464140464E-01_DP, &
    8.81627267443757652E-01_DP, 3.32140828186276754E+00_DP, 1.49957629868625547E+01_DP, &
    7.89230130115865181E+01_DP, 4.74451538868264323E+02_DP, 3.20749009089066193E+03_DP, &
    2.40865496408740049E+04_DP, 1.98923119169509794E+05_DP, 1.79190200777534383E+06_DP ]
  REAL(DP), PARAMETER :: br(14) = [ 1.00000000000000000E+00_DP, -1.45833333333333333E-01_DP, &
    -9.87413194444444444E-02_DP, -1.43312053915895062E-01_DP, -3.17227202678413548E-01_DP, &
    -9.42429147957120249E-01_DP, -3.51120304082635426E+00_DP, -1.57272636203680451E+01_DP, &
    -8.22814390971859444E+01_DP, -4.92355370523670524E+02_DP, -3.31621856854797251E+03_DP, &
    -2.48276742452085896E+04_DP, -2.04526587315129788E+05_DP, -1.83844491706820990E+06_DP ]
  REAL(DP), PARAMETER :: c(105) = [ 1.00000000000000000E+00_DP, -2.08333333333333333E-01_DP, &
    1.25000000000000000E-01_DP,  3.34201388888888889E-01_DP,-4.01041666666666667E-01_DP, &
    7.03125000000000000E-02_DP, -1.02581259645061728E+00_DP, 1.84646267361111111E+00_DP, &
    -8.91210937500000000E-01_DP, 7.32421875000000000E-02_DP, 4.66958442342624743E+00_DP, &
    -1.12070026162229938E+01_DP, 8.78912353515625000E+00_DP,-2.36408691406250000E+00_DP, &
    1.12152099609375000E-01_DP, -2.82120725582002449E+01_DP, 8.46362176746007346E+01_DP, &
    -9.18182415432400174E+01_DP, 4.25349987453884549E+01_DP,-7.36879435947963170E+00_DP, &
    2.27108001708984375E-01_DP,  2.12570130039217123E+02_DP,-7.65252468141181642E+02_DP, &
    1.05999045252799988E+03_DP, -6.99579627376132541E+02_DP, 2.18190511744211590E+02_DP, &
    -2.64914304869515555E+01_DP, 5.72501420974731445E-01_DP,-1.91945766231840700E+03_DP, &
    8.06172218173730938E+03_DP, -1.35865500064341374E+04_DP, 1.16553933368645332E+04_DP, &
    -5.30564697861340311E+03_DP, 1.20090291321635246E+03_DP,-1.08090919788394656E+02_DP, &
    1.72772750258445740E+00_DP,  2.02042913309661486E+04_DP,-9.69805983886375135E+04_DP, &
    1.92547001232531532E+05_DP, -2.03400177280415534E+05_DP, 1.22200464983017460E+05_DP, &
    -4.11926549688975513E+04_DP, 7.10951430248936372E+03_DP,-4.93915304773088012E+02_DP, &
    6.07404200127348304E+00_DP, -2.42919187900551333E+05_DP, 1.31176361466297720E+06_DP, &
    -2.99801591853810675E+06_DP, 3.76327129765640400E+06_DP,-2.81356322658653411E+06_DP, &
    1.26836527332162478E+06_DP, -3.31645172484563578E+05_DP, 4.52187689813627263E+04_DP, &
    -2.49983048181120962E+03_DP, 2.43805296995560639E+01_DP, 3.28446985307203782E+06_DP, &
    -1.97068191184322269E+07_DP, 5.09526024926646422E+07_DP,-7.41051482115326577E+07_DP, &
    6.63445122747290267E+07_DP, -3.75671766607633513E+07_DP, 1.32887671664218183E+07_DP, &
    -2.78561812808645469E+06_DP, 3.08186404612662398E+05_DP,-1.38860897537170405E+04_DP, &
    1.10017140269246738E+02_DP, -4.93292536645099620E+07_DP, 3.25573074185765749E+08_DP, &
    -9.39462359681578403E+08_DP, 1.55359689957058006E+09_DP,-1.62108055210833708E+09_DP, &
    1.10684281682301447E+09_DP, -4.95889784275030309E+08_DP, 1.42062907797533095E+08_DP, &
    -2.44740627257387285E+07_DP, 2.24376817792244943E+06_DP,-8.40054336030240853E+04_DP, &
    5.51335896122020586E+02_DP,  8.14789096118312115E+08_DP,-5.86648149205184723E+09_DP, &
    1.86882075092958249E+10_DP, -3.46320433881587779E+10_DP, 4.12801855797539740E+10_DP, &
    -3.30265997498007231E+10_DP, 1.79542137311556001E+10_DP,-6.56329379261928433E+09_DP, &
    1.55927986487925751E+09_DP, -2.25105661889415278E+08_DP, 1.73951075539781645E+07_DP, &
    -5.49842327572288687E+05_DP, 3.03809051092238427E+03_DP,-1.46792612476956167E+10_DP, &
    1.14498237732025810E+11_DP, -3.99096175224466498E+11_DP, 8.19218669548577329E+11_DP, &
    -1.09837515608122331E+12_DP, 1.00815810686538209E+12_DP,-6.45364869245376503E+11_DP, &
    2.87900649906150589E+11_DP, -8.78670721780232657E+10_DP, 1.76347306068349694E+10_DP, &
    -2.16716498322379509E+09_DP, 1.43157876718888981E+08_DP,-3.87183344257261262E+06_DP, &
    1.82577554742931747E+04_DP ]
  REAL(DP), PARAMETER :: alfa(180) = [ -4.44444444444444444E-03_DP, -9.22077922077922078E-04_DP, &
    -8.84892884892884893E-05_DP, 1.65927687832449737E-04_DP, 2.46691372741792910E-04_DP, &
    2.65995589346254780E-04_DP, 2.61824297061500945E-04_DP, 2.48730437344655609E-04_DP, &
    2.32721040083232098E-04_DP, 2.16362485712365082E-04_DP, 2.00738858762752355E-04_DP, &
    1.86267636637545172E-04_DP, 1.73060775917876493E-04_DP, 1.61091705929015752E-04_DP, &
    1.50274774160908134E-04_DP, 1.40503497391269794E-04_DP, 1.31668816545922806E-04_DP, &
    1.23667445598253261E-04_DP, 1.16405271474737902E-04_DP, 1.09798298372713369E-04_DP, &
    1.03772410422992823E-04_DP, 9.82626078369363448E-05_DP, 9.32120517249503256E-05_DP, &
    8.85710852478711718E-05_DP, 8.42963105715700223E-05_DP, 8.03497548407791151E-05_DP, &
    7.66981345359207388E-05_DP, 7.33122157481777809E-05_DP, 7.01662625163141333E-05_DP, &
    6.72375633790160292E-05_DP, 6.93735541354588974E-04_DP, 2.32241745182921654E-04_DP, &
    -1.41986273556691197E-05_DP, -1.16444931672048640E-04_DP, -1.50803558053048762E-04_DP, &
    -1.55121924918096223E-04_DP, -1.46809756646465549E-04_DP, -1.33815503867491367E-04_DP, &
    -1.19744975684254051E-04_DP, -1.06184319207974020E-04_DP, -9.37699549891194492E-05_DP, &
    -8.26923045588193274E-05_DP, -7.29374348155221211E-05_DP, -6.44042357721016283E-05_DP, &
    -5.69611566009369048E-05_DP, -5.04731044303561628E-05_DP, -4.48134868008882786E-05_DP, &
    -3.98688727717598864E-05_DP, -3.55400532972042498E-05_DP, -3.17414256609022480E-05_DP, &
    -2.83996793904174811E-05_DP, -2.54522720634870566E-05_DP, -2.28459297164724555E-05_DP, &
    -2.05352753106480604E-05_DP, -1.84816217627666085E-05_DP, -1.66519330021393806E-05_DP, &
    -1.50179412980119482E-05_DP, -1.35554031379040526E-05_DP, -1.22434746473858131E-05_DP, &
    -1.10641884811308169E-05_DP, -3.54211971457743841E-04_DP, -1.56161263945159416E-04_DP, &
    3.04465503594936410E-05_DP, 1.30198655773242693E-04_DP, 1.67471106699712269E-04_DP, &
    1.70222587683592569E-04_DP, 1.56501427608594704E-04_DP, 1.36339170977445120E-04_DP, &
    1.14886692029825128E-04_DP, 9.45869093034688111E-05_DP, 7.64498419250898258E-05_DP, &
    6.07570334965197354E-05_DP, 4.74394299290508799E-05_DP, 3.62757512005344297E-05_DP, &
    2.69939714979224901E-05_DP, 1.93210938247939253E-05_DP, 1.30056674793963203E-05_DP, &
    7.82620866744496661E-06_DP, 3.59257485819351583E-06_DP, 1.44040049814251817E-07_DP, &
    -2.65396769697939116E-06_DP, -4.91346867098485910E-06_DP, -6.72739296091248287E-06_DP, &
    -8.17269379678657923E-06_DP, -9.31304715093561232E-06_DP, -1.02011418798016441E-05_DP, &
    -1.08805962510592880E-05_DP, -1.13875481509603555E-05_DP, - 1.17519675674556414E-05_DP, &
    -1.19987364870944141E-05_DP, 3.78194199201772914E-04_DP, 2.02471952761816167E-04_DP, &
    -6.37938506318862408E-05_DP, -2.38598230603005903E-04_DP, -3.10916256027361568E-04_DP, &
    -3.13680115247576316E-04_DP, -2.78950273791323387E-04_DP, -2.28564082619141374E-04_DP, &
    -1.75245280340846749E-04_DP, -1.25544063060690348E-04_DP, -8.22982872820208365E-05_DP, &
    -4.62860730588116458E-05_DP, -1.72334302366962267E-05_DP, 5.60690482304602267E-06_DP, &
    2.31395443148286800E-05_DP, 3.62642745856793957E-05_DP, 4.58006124490188752E-05_DP, &
    5.24595294959114050E-05_DP, 5.68396208545815266E-05_DP, 5.94349820393104052E-05_DP, &
    6.06478527578421742E-05_DP, 6.08023907788436497E-05_DP, 6.01577894539460388E-05_DP, &
    5.89199657344698500E-05_DP, 5.72515823777593053E-05_DP, 5.52804375585852577E-05_DP, &
    5.31063773802880170E-05_DP, 5.08069302012325706E-05_DP, 4.84418647620094842E-05_DP, &
    4.60568581607475370E-05_DP, -6.91141397288294174E-04_DP, -4.29976633058871912E-04_DP, &
    1.83067735980039018E-04_DP, 6.60088147542014144E-04_DP, 8.75964969951185931E-04_DP, &
    8.77335235958235514E-04_DP, 7.49369585378990637E-04_DP, 5.63832329756980918E-04_DP, &
    3.68059319971443156E-04_DP, 1.88464535514455599E-04_DP, 3.70663057664904149E-05_DP, &
    -8.28520220232137023E-05_DP, -1.72751952869172998E-04_DP, -2.36314873605872983E-04_DP, &
    -2.77966150694906658E-04_DP, -3.02079514155456919E-04_DP, -3.12594712643820127E-04_DP, &
    -3.12872558758067163E-04_DP, -3.05678038466324377E-04_DP, -2.93226470614557331E-04_DP, &
    -2.77255655582934777E-04_DP, -2.59103928467031709E-04_DP, -2.39784014396480342E-04_DP, &
    -2.20048260045422848E-04_DP, -2.00443911094971498E-04_DP, -1.81358692210970687E-04_DP, &
    -1.63057674478657464E-04_DP, -1.45712672175205844E-04_DP, -1.29425421983924587E-04_DP, &
    -1.14245691942445952E-04_DP, 1.92821964248775885E-03_DP, 1.35592576302022234E-03_DP, &
    -7.17858090421302995E-04_DP, -2.58084802575270346E-03_DP, -3.49271130826168475E-03_DP, &
    -3.46986299340960628E-03_DP, -2.82285233351310182E-03_DP, -1.88103076404891354E-03_DP, &
    -8.89531718383947600E-04_DP, 3.87912102631035228E-06_DP, 7.28688540119691412E-04_DP, &
    1.26566373053457758E-03_DP, 1.62518158372674427E-03_DP, 1.83203153216373172E-03_DP, &
    1.91588388990527909E-03_DP, 1.90588846755546138E-03_DP, 1.82798982421825727E-03_DP, &
    1.70389506421121530E-03_DP, 1.55097127171097686E-03_DP, 1.38261421852276159E-03_DP, &
    1.20881424230064774E-03_DP, 1.03676532638344962E-03_DP, 8.71437918068619115E-04_DP, &
    7.16080155297701002E-04_DP, 5.72637002558129372E-04_DP, 4.42089819465802277E-04_DP, &
    3.24724948503090564E-04_DP, 2.20342042730246599E-04_DP, 1.28412898401353882E-04_DP, &
    4.82005924552095464E-05_DP ]
  REAL(DP), PARAMETER :: beta(210) = [ 1.79988721413553309E-02_DP, 5.59964911064388073E-03_DP, &
    2.88501402231132779E-03_DP, 1.80096606761053941E-03_DP, 1.24753110589199202E-03_DP, &
    9.22878876572938311E-04_DP, 7.14430421727287357E-04_DP, 5.71787281789704872E-04_DP, &
    4.69431007606481533E-04_DP, 3.93232835462916638E-04_DP, 3.34818889318297664E-04_DP, &
    2.88952148495751517E-04_DP, 2.52211615549573284E-04_DP, 2.22280580798883327E-04_DP, &
    1.97541838033062524E-04_DP, 1.76836855019718004E-04_DP, 1.59316899661821081E-04_DP, &
    1.44347930197333986E-04_DP, 1.31448068119965379E-04_DP, 1.20245444949302884E-04_DP, &
    1.10449144504599392E-04_DP, 1.01828770740567258E-04_DP, 9.41998224204237509E-05_DP, &
    8.74130545753834437E-05_DP, 8.13466262162801467E-05_DP, 7.59002269646219339E-05_DP, &
    7.09906300634153481E-05_DP, 6.65482874842468183E-05_DP, 6.25146958969275078E-05_DP, &
    5.88403394426251749E-05_DP, -1.49282953213429172E-03_DP, -8.78204709546389328E-04_DP, &
    -5.02916549572034614E-04_DP, -2.94822138512746025E-04_DP, -1.75463996970782828E-04_DP, &
    -1.04008550460816434E-04_DP, -5.96141953046457895E-05_DP, -3.12038929076098340E-05_DP, &
    -1.26089735980230047E-05_DP, -2.42892608575730389E-07_DP, 8.05996165414273571E-06_DP, &
    1.36507009262147391E-05_DP, 1.73964125472926261E-05_DP, 1.98672978842133780E-05_DP, &
    2.14463263790822639E-05_DP, 2.23954659232456514E-05_DP, 2.28967783814712629E-05_DP, &
    2.30785389811177817E-05_DP, 2.30321976080909144E-05_DP, 2.28236073720348722E-05_DP, &
    2.25005881105292418E-05_DP, 2.20981015361991429E-05_DP, 2.16418427448103905E-05_DP, &
    2.11507649256220843E-05_DP, 2.06388749782170737E-05_DP, 2.01165241997081666E-05_DP, &
    1.95913450141179244E-05_DP, 1.90689367910436740E-05_DP, 1.85533719641636667E-05_DP, &
    1.80475722259674218E-05_DP, 5.52213076721292790E-04_DP, 4.47932581552384646E-04_DP, &
    2.79520653992020589E-04_DP, 1.52468156198446602E-04_DP, 6.93271105657043598E-05_DP, &
    1.76258683069991397E-05_DP, - 1.35744996343269136E-05_DP, -3.17972413350427135E-05_DP, &
    -4.18861861696693365E-05_DP, -4.69004889379141029E-05_DP, -4.87665447413787352E-05_DP, &
    -4.87010031186735069E-05_DP, -4.74755620890086638E-05_DP, -4.55813058138628452E-05_DP, &
    -4.33309644511266036E-05_DP, -4.09230193157750364E-05_DP, -3.84822638603221274E-05_DP, &
    -3.60857167535410501E-05_DP, -3.37793306123367417E-05_DP, -3.15888560772109621E-05_DP, &
    -2.95269561750807315E-05_DP, -2.75978914828335759E-05_DP, -2.58006174666883713E-05_DP, &
    -2.41308356761280200E-05_DP, -2.25823509518346033E-05_DP, -2.11479656768912971E-05_DP, &
    -1.98200638885294927E-05_DP, -1.85909870801065077E-05_DP, - 1.74532699844210224E-05_DP, &
    -1.63997823854497997E-05_DP, -4.74617796559959808E-04_DP, -4.77864567147321487E-04_DP, &
    -3.20390228067037603E-04_DP, -1.61105016119962282E-04_DP, -4.25778101285435204E-05_DP, &
    3.44571294294967503E-05_DP, 7.97092684075674924E-05_DP, 1.03138236708272200E-04_DP, &
    1.12466775262204158E-04_DP, 1.13103642108481389E-04_DP, 1.08651634848774268E-04_DP, &
    1.01437951597661973E-04_DP, 9.29298396593363896E-05_DP, 8.40293133016089978E-05_DP, &
    7.52727991349134062E-05_DP, 6.69632521975730872E-05_DP, 5.92564547323194704E-05_DP, &
    5.22169308826975567E-05_DP, 4.58539485165360646E-05_DP, 4.01445513891486808E-05_DP, &
    3.50481730031328081E-05_DP, 3.05157995034346659E-05_DP, 2.64956119950516039E-05_DP, &
    2.29363633690998152E-05_DP, 1.97893056664021636E-05_DP, 1.70091984636412623E-05_DP, &
    1.45547428261524004E-05_DP, 1.23886640995878413E-05_DP, 1.04775876076583236E-05_DP, &
    8.79179954978479373E-06_DP, 7.36465810572578444E-04_DP, 8.72790805146193976E-04_DP, &
    6.22614862573135066E-04_DP, 2.85998154194304147E-04_DP, 3.84737672879366102E-06_DP, &
    -1.87906003636971558E-04_DP, -2.97603646594554535E-04_DP, -3.45998126832656348E-04_DP, &
    -3.53382470916037712E-04_DP, -3.35715635775048757E-04_DP, - 3.04321124789039809E-04_DP, &
    -2.66722723047612821E-04_DP, -2.27654214122819527E-04_DP, -1.89922611854562356E-04_DP, &
    -1.55058918599093870E-04_DP, -1.23778240761873630E-04_DP, -9.62926147717644187E-05_DP, &
    -7.25178327714425337E-05_DP, -5.22070028895633801E-05_DP, -3.50347750511900522E-05_DP, &
    -2.06489761035551757E-05_DP, -8.70106096849767054E-06_DP, 1.13698686675100290E-06_DP, &
    9.16426474122778849E-06_DP, 1.56477785428872620E-05_DP, 2.08223629482466847E-05_DP, &
    2.48923381004595156E-05_DP, 2.80340509574146325E-05_DP, 3.03987774629861915E-05_DP, &
    3.21156731406700616E-05_DP, - 1.80182191963885708E-03_DP, -2.43402962938042533E-03_DP, &
    -1.83422663549856802E-03_DP, -7.62204596354009765E-04_DP, 2.39079475256927218E-04_DP, &
    9.49266117176881141E-04_DP, 1.34467449701540359E-03_DP, 1.48457495259449178E-03_DP, &
    1.44732339830617591E-03_DP, 1.30268261285657186E-03_DP, 1.10351597375642682E-03_DP, &
    8.86047440419791759E-04_DP, 6.73073208165665473E-04_DP, 4.77603872856582378E-04_DP, &
    3.05991926358789362E-04_DP, 1.60315694594721630E-04_DP, 4.00749555270613286E-05_DP, &
    -5.66607461635251611E-05_DP, -1.32506186772982638E-04_DP, -1.90296187989614057E-04_DP, &
    - 2.32811450376937408E-04_DP, -2.62628811464668841E-04_DP, -2.82050469867598672E-04_DP, &
    -2.93081563192861167E-04_DP, -2.97435962176316616E-04_DP, -2.96557334239348078E-04_DP, &
    -2.91647363312090861E-04_DP, -2.83696203837734166E-04_DP, -2.73512317095673346E-04_DP, &
    -2.61750155806768580E-04_DP, 6.38585891212050914E-03_DP, 9.62374215806377941E-03_DP, &
    7.61878061207001043E-03_DP, 2.83219055545628054E-03_DP, -2.09841352012720090E-03_DP, &
    -5.73826764216626498E-03_DP, -7.70804244495414620E-03_DP, -8.21011692264844401E-03_DP, &
    -7.65824520346905413E-03_DP, -6.47209729391045177E-03_DP, - 4.99132412004966473E-03_DP, &
    -3.45612289713133280E-03_DP, -2.01785580014170775E-03_DP, -7.59430686781961401E-04_DP, &
    2.84173631523859138E-04_DP, 1.10891667586337403E-03_DP, 1.72901493872728771E-03_DP, &
    2.16812590802684701E-03_DP, 2.45357710494539735E-03_DP, 2.61281821058334862E-03_DP, &
    2.67141039656276912E-03_DP, 2.65203073395980430E-03_DP, 2.57411652877287315E-03_DP, &
    2.45389126236094427E-03_DP, 2.30460058071795494E-03_DP, 2.13684837686712662E-03_DP, &
    1.95896528478870911E-03_DP, 1.77737008679454412E-03_DP, 1.59690280765839059E-03_DP, &
    1.42111975664438546E-03_DP ]
  REAL(DP), PARAMETER :: gama(30) = [ 6.29960524947436582E-01_DP, 2.51984209978974633E-01_DP, &
    1.54790300415655846E-01_DP, 1.10713062416159013E-01_DP, 8.57309395527394825E-02_DP, &
    6.97161316958684292E-02_DP, 5.86085671893713576E-02_DP, 5.04698873536310685E-02_DP, &
    4.42600580689154809E-02_DP, 3.93720661543509966E-02_DP, 3.54283195924455368E-02_DP, &
    3.21818857502098231E-02_DP, 2.94646240791157679E-02_DP, 2.71581677112934479E-02_DP, &
    2.51768272973861779E-02_DP, 2.34570755306078891E-02_DP, 2.19508390134907203E-02_DP, &
    2.06210828235646240E-02_DP, 1.94388240897880846E-02_DP, 1.83810633800683158E-02_DP, &
    1.74293213231963172E-02_DP, 1.65685837786612353E-02_DP, 1.57865285987918445E-02_DP, &
    1.50729501494095594E-02_DP, 1.44193250839954639E-02_DP, 1.38184805735341786E-02_DP, &
    1.32643378994276568E-02_DP, 1.27517121970498651E-02_DP, 1.22761545318762767E-02_DP, &
    1.18338262398482403E-02_DP ]
  REAL(DP), PARAMETER :: ex1 = 3.33333333333333333E-01_DP, ex2 = 6.66666666666666667E-01_DP, &
    hpi = 1.57079632679489662E+00_DP, gpi = 3.14159265358979324E+00_DP, &
    thpi = 4.71238898038468986_DP
  REAL(DP), PARAMETER :: zeror = 0._DP, zeroi = 0._DP, coner = 1._DP, conei = 0._DP
  !* FIRST EXECUTABLE STATEMENT  ZUNHJ
  rfnu = 1._DP/Fnu
  !-----------------------------------------------------------------------
  !     OVERFLOW TEST (Z/FNU TOO SMALL)
  !-----------------------------------------------------------------------
  test = D1MACH(1)*1.E+3_DP
  ac = Fnu*test
  IF( ABS(Zr)>ac .OR. ABS(Zi)>ac ) THEN
    zbr = Zr*rfnu
    zbi = Zi*rfnu
    rfnu2 = rfnu*rfnu
    !-----------------------------------------------------------------------
    !     COMPUTE IN THE FOURTH QUADRANT
    !-----------------------------------------------------------------------
    fn13 = Fnu**ex1
    fn23 = fn13*fn13
    rfn13 = 1._DP/fn13
    w2r = coner - zbr*zbr + zbi*zbi
    w2i = conei - zbr*zbi - zbr*zbi
    aw2 = ZABS(w2r,w2i)
    IF( aw2>0.25_DP ) THEN
      !-----------------------------------------------------------------------
      !     ABS(W2)>0.25D0
      !-----------------------------------------------------------------------
      CALL ZSQRT(w2r,w2i,wr,wi)
      IF( wr<0._DP ) wr = 0._DP
      IF( wi<0._DP ) wi = 0._DP
      str = coner + wr
      sti = wi
      CALL ZDIV(str,sti,zbr,zbi,zar,zai)
      CALL ZLOG(zar,zai,zcr,zci)
      IF( zci<0._DP ) zci = 0._DP
      IF( zci>hpi ) zci = hpi
      IF( zcr<0._DP ) zcr = 0._DP
      zthr = (zcr-wr)*1.5_DP
      zthi = (zci-wi)*1.5_DP
      Zeta1r = zcr*Fnu
      Zeta1i = zci*Fnu
      Zeta2r = wr*Fnu
      Zeta2i = wi*Fnu
      azth = ZABS(zthr,zthi)
      ang = thpi
      IF( zthr<0._DP .OR. zthi>=0._DP ) THEN
        ang = hpi
        IF( zthr/=0._DP ) THEN
          ang = ATAN(zthi/zthr)
          IF( zthr<0._DP ) ang = ang + gpi
        END IF
      END IF
      pp = azth**ex2
      ang = ang*ex2
      zetar = pp*COS(ang)
      zetai = pp*SIN(ang)
      IF( zetai<0._DP ) zetai = 0._DP
      Argr = zetar*fn23
      Argi = zetai*fn23
      CALL ZDIV(zthr,zthi,zetar,zetai,rtztr,rtzti)
      CALL ZDIV(rtztr,rtzti,wr,wi,zar,zai)
      tzar = zar + zar
      tzai = zai + zai
      CALL ZSQRT(tzar,tzai,str,sti)
      Phir = str*rfn13
      Phii = sti*rfn13
      IF( Ipmtr/=1 ) THEN
        raw = 1._DP/SQRT(aw2)
        str = wr*raw
        sti = -wi*raw
        tfnr = str*rfnu*raw
        tfni = sti*rfnu*raw
        razth = 1._DP/azth
        str = zthr*razth
        sti = -zthi*razth
        rzthr = str*razth*rfnu
        rzthi = sti*razth*rfnu
        zcr = rzthr*ar(2)
        zci = rzthi*ar(2)
        raw2 = 1._DP/aw2
        str = w2r*raw2
        sti = -w2i*raw2
        t2r = str*raw2
        t2i = sti*raw2
        str = t2r*c(2) + c(3)
        sti = t2i*c(2)
        upr(2) = str*tfnr - sti*tfni
        upi(2) = str*tfni + sti*tfnr
        Bsumr = upr(2) + zcr
        Bsumi = upi(2) + zci
        Asumr = zeror
        Asumi = zeroi
        IF( rfnu>=Tol ) THEN
          przthr = rzthr
          przthi = rzthi
          ptfnr = tfnr
          ptfni = tfni
          upr(1) = coner
          upi(1) = conei
          pp = 1._DP
          btol = Tol*(ABS(Bsumr)+ABS(Bsumi))
          ks = 0
          kp1 = 2
          l = 3
          ias = 0
          ibs = 0
          DO lr = 2, 12, 2
            lrp1 = lr + 1
            !-----------------------------------------------------------------------
            !     COMPUTE TWO ADDITIONAL CR, DR, AND UP FOR TWO MORE TERMS IN
            !     NEXT SUMA AND SUMB
            !-----------------------------------------------------------------------
            DO k = lr, lrp1
              ks = ks + 1
              kp1 = kp1 + 1
              l = l + 1
              zar = c(l)
              zai = zeroi
              DO j = 2, kp1
                l = l + 1
                str = zar*t2r - t2i*zai + c(l)
                zai = zar*t2i + zai*t2r
                zar = str
              END DO
              str = ptfnr*tfnr - ptfni*tfni
              ptfni = ptfnr*tfni + ptfni*tfnr
              ptfnr = str
              upr(kp1) = ptfnr*zar - ptfni*zai
              upi(kp1) = ptfni*zar + ptfnr*zai
              crr(ks) = przthr*br(ks+1)
              cri(ks) = przthi*br(ks+1)
              str = przthr*rzthr - przthi*rzthi
              przthi = przthr*rzthi + przthi*rzthr
              przthr = str
              drr(ks) = przthr*ar(ks+2)
              dri(ks) = przthi*ar(ks+2)
            END DO
            pp = pp*rfnu2
            IF( ias/=1 ) THEN
              sumar = upr(lrp1)
              sumai = upi(lrp1)
              ju = lrp1
              DO jr = 1, lr
                ju = ju - 1
                sumar = sumar + crr(jr)*upr(ju) - cri(jr)*upi(ju)
                sumai = sumai + crr(jr)*upi(ju) + cri(jr)*upr(ju)
              END DO
              Asumr = Asumr + sumar
              Asumi = Asumi + sumai
              test = ABS(sumar) + ABS(sumai)
              IF( pp<Tol .AND. test<Tol ) ias = 1
            END IF
            IF( ibs/=1 ) THEN
              sumbr = upr(lr+2) + upr(lrp1)*zcr - upi(lrp1)*zci
              sumbi = upi(lr+2) + upr(lrp1)*zci + upi(lrp1)*zcr
              ju = lrp1
              DO jr = 1, lr
                ju = ju - 1
                sumbr = sumbr + drr(jr)*upr(ju) - dri(jr)*upi(ju)
                sumbi = sumbi + drr(jr)*upi(ju) + dri(jr)*upr(ju)
              END DO
              Bsumr = Bsumr + sumbr
              Bsumi = Bsumi + sumbi
              test = ABS(sumbr) + ABS(sumbi)
              IF( pp<btol .AND. test<btol ) ibs = 1
            END IF
            IF( ias==1 .AND. ibs==1 ) EXIT
          END DO
        END IF
        Asumr = Asumr + coner
        str = -Bsumr*rfn13
        sti = -Bsumi*rfn13
        CALL ZDIV(str,sti,rtztr,rtzti,Bsumr,Bsumi)
      END IF
    ELSE
      !-----------------------------------------------------------------------
      !     POWER SERIES FOR ABS(W2)<=0.25D0
      !-----------------------------------------------------------------------
      k = 1
      pr(1) = coner
      pi(1) = conei
      sumar = gama(1)
      sumai = zeroi
      ap(1) = 1._DP
      IF( aw2>=Tol ) THEN
        DO k = 2, 30
          pr(k) = pr(k-1)*w2r - pi(k-1)*w2i
          pi(k) = pr(k-1)*w2i + pi(k-1)*w2r
          sumar = sumar + pr(k)*gama(k)
          sumai = sumai + pi(k)*gama(k)
          ap(k) = ap(k-1)*aw2
          IF( ap(k)<Tol ) GOTO 20
        END DO
        k = 30
      END IF
      20  kmax = k
      zetar = w2r*sumar - w2i*sumai
      zetai = w2r*sumai + w2i*sumar
      Argr = zetar*fn23
      Argi = zetai*fn23
      CALL ZSQRT(sumar,sumai,zar,zai)
      CALL ZSQRT(w2r,w2i,str,sti)
      Zeta2r = str*Fnu
      Zeta2i = sti*Fnu
      str = coner + ex2*(zetar*zar-zetai*zai)
      sti = conei + ex2*(zetar*zai+zetai*zar)
      Zeta1r = str*Zeta2r - sti*Zeta2i
      Zeta1i = str*Zeta2i + sti*Zeta2r
      zar = zar + zar
      zai = zai + zai
      CALL ZSQRT(zar,zai,str,sti)
      Phir = str*rfn13
      Phii = sti*rfn13
      IF( Ipmtr/=1 ) THEN
        !-----------------------------------------------------------------------
        !     SUM SERIES FOR ASUM AND BSUM
        !-----------------------------------------------------------------------
        sumbr = zeror
        sumbi = zeroi
        DO k = 1, kmax
          sumbr = sumbr + pr(k)*beta(k)
          sumbi = sumbi + pi(k)*beta(k)
        END DO
        Asumr = zeror
        Asumi = zeroi
        Bsumr = sumbr
        Bsumi = sumbi
        l1 = 0
        l2 = 30
        btol = Tol*(ABS(Bsumr)+ABS(Bsumi))
        atol = Tol
        pp = 1._DP
        ias = 0
        ibs = 0
        IF( rfnu2>=Tol ) THEN
          DO is = 2, 7
            atol = atol/rfnu2
            pp = pp*rfnu2
            IF( ias/=1 ) THEN
              sumar = zeror
              sumai = zeroi
              DO k = 1, kmax
                m = l1 + k
                sumar = sumar + pr(k)*alfa(m)
                sumai = sumai + pi(k)*alfa(m)
                IF( ap(k)<atol ) EXIT
              END DO
              Asumr = Asumr + sumar*pp
              Asumi = Asumi + sumai*pp
              IF( pp<Tol ) ias = 1
            END IF
            IF( ibs/=1 ) THEN
              sumbr = zeror
              sumbi = zeroi
              DO k = 1, kmax
                m = l2 + k
                sumbr = sumbr + pr(k)*beta(m)
                sumbi = sumbi + pi(k)*beta(m)
                IF( ap(k)<atol ) EXIT
              END DO
              Bsumr = Bsumr + sumbr*pp
              Bsumi = Bsumi + sumbi*pp
              IF( pp<btol ) ibs = 1
            END IF
            IF( ias==1 .AND. ibs==1 ) EXIT
            l1 = l1 + 30
            l2 = l2 + 30
          END DO
        END IF
        Asumr = Asumr + coner
        pp = rfnu*rfn13
        Bsumr = Bsumr*pp
        Bsumi = Bsumi*pp
      END IF
    END IF
  ELSE
    Zeta1r = 2._DP*ABS(LOG(test)) + Fnu
    Zeta1i = 0._DP
    Zeta2r = Fnu
    Zeta2i = 0._DP
    Phir = 1._DP
    Phii = 0._DP
    Argr = 1._DP
    Argi = 0._DP
    RETURN
  END IF
  RETURN
END SUBROUTINE ZUNHJ
