!** DPSIXN
REAL(8) FUNCTION DPSIXN(N)
  IMPLICIT NONE
  !>
  !***
  !  Subsidiary to DEXINT
  !***
  ! **Library:**   SLATEC
  !***
  ! **Type:**      DOUBLE PRECISION (PSIXN-S, DPSIXN-D)
  !***
  ! **Author:**  Amos, D. E., (SNLA)
  !***
  ! **Description:**
  !
  !     This subroutine returns values of PSI(X)=derivative of log
  !     GAMMA(X), X.GT.0.0 at integer arguments. A table look-up is
  !     performed for N .LE. 100, and the asymptotic expansion is
  !     evaluated for N.GT.100.
  !
  !***
  ! **See also:**  DEXINT
  !***
  ! **Routines called:**  D1MACH

  !* REVISION HISTORY  (YYMMDD)
  !   800501  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   890911  Removed unnecessary intrinsics.  (WRB)
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   900328  Added TYPE section.  (WRB)
  !   910722  Updated AUTHOR section.  (ALS)

  !
  INTEGER N, k
  REAL(8) :: ax, fn, rfn2, trm, s, wdtol
  REAL(8) :: D1MACH
  !
  !             DPSIXN(N), N = 1,100
  REAL(8), PARAMETER :: c(100) = [ -5.77215664901532861D-01, 4.22784335098467139D-01, &
    9.22784335098467139D-01, 1.25611766843180047D+00, 1.50611766843180047D+00, &
    1.70611766843180047D+00, 1.87278433509846714D+00, 2.01564147795561000D+00, &
    2.14064147795561000D+00, 2.25175258906672111D+00, 2.35175258906672111D+00, &
    2.44266167997581202D+00, 2.52599501330914535D+00, 2.60291809023222227D+00, &
    2.67434666166079370D+00, 2.74101332832746037D+00, 2.80351332832746037D+00, &
    2.86233685773922507D+00, 2.91789241329478063D+00, 2.97052399224214905D+00, &
    3.02052399224214905D+00, 3.06814303986119667D+00, 3.11359758531574212D+00, &
    3.15707584618530734D+00, 3.19874251285197401D+00, 3.23874251285197401D+00, &
    3.27720405131351247D+00, 3.31424108835054951D+00, 3.34995537406483522D+00, &
    3.38443813268552488D+00, 3.41777146601885821D+00, 3.45002953053498724D+00, &
    3.48127953053498724D+00, 3.51158256083801755D+00, 3.54099432554389990D+00, &
    3.56956575411532847D+00, 3.59734353189310625D+00, 3.62437055892013327D+00, &
    3.65068634839381748D+00, 3.67632737403484313D+00, 3.70132737403484313D+00, &
    3.72571761793728215D+00, 3.74952714174680596D+00, 3.77278295570029433D+00, &
    3.79551022842756706D+00, 3.81773245064978928D+00, 3.83947158108457189D+00, &
    3.86074817682925274D+00, 3.88158151016258607D+00, 3.90198967342789220D+00, &
    3.92198967342789220D+00, 3.94159751656514710D+00, 3.96082828579591633D+00, &
    3.97969621032421822D+00, 3.99821472884273674D+00, 4.01639654702455492D+00, &
    4.03425368988169777D+00, 4.05179754953082058D+00, 4.06903892884116541D+00, &
    4.08598808138353829D+00, 4.10265474805020496D+00, 4.11904819067315578D+00, &
    4.13517722293122029D+00, 4.15105023880423617D+00, 4.16667523880423617D+00, &
    4.18205985418885155D+00, 4.19721136934036670D+00, 4.21213674247469506D+00, &
    4.22684262482763624D+00, 4.24133537845082464D+00, 4.25562109273653893D+00, &
    4.26970559977879245D+00, 4.28359448866768134D+00, 4.29729311880466764D+00, &
    4.31080663231818115D+00, 4.32413996565151449D+00, 4.33729786038835659D+00, &
    4.35028487337536958D+00, 4.36310538619588240D+00, 4.37576361404398366D+00, &
    4.38826361404398366D+00, 4.40060929305632934D+00, 4.41280441500754886D+00, &
    4.42485260777863319D+00, 4.43675736968339510D+00, 4.44852207556574804D+00, &
    4.46014998254249223D+00, 4.47164423541605544D+00, 4.48300787177969181D+00, &
    4.49424382683587158D+00, 4.50535493794698269D+00, 4.51634394893599368D+00, &
    4.52721351415338499D+00, 4.53796620232542800D+00, 4.54860450019776842D+00, &
    4.55913081598724211D+00, 4.56954748265390877D+00, 4.57985676100442424D+00, &
    4.59006084263707730D+00, 4.60016185273808740D+00 ]
  !             COEFFICIENTS OF ASYMPTOTIC EXPANSION
  REAL(8), PARAMETER :: b(6) = [ 8.33333333333333333D-02, -8.33333333333333333D-03, &
    3.96825396825396825D-03, -4.16666666666666666D-03, 7.57575757575757576D-03, &
    -2.10927960927960928D-02 ]
  !
  !* FIRST EXECUTABLE STATEMENT  DPSIXN
  IF ( N>100 ) THEN
    wdtol = MAX(D1MACH(4),1.0D-18)
    fn = N
    ax = 1.0D0
    s = -0.5D0/fn
    IF ( ABS(s)>wdtol ) THEN
      rfn2 = 1.0D0/(fn*fn)
      DO k = 1, 6
        ax = ax*rfn2
        trm = -b(k)*ax
        IF ( ABS(trm)<wdtol ) EXIT
        s = s + trm
      ENDDO
    ENDIF
    DPSIXN = s + LOG(fn)
  ELSE
    DPSIXN = c(N)
    RETURN
  ENDIF
END FUNCTION DPSIXN
