!** DAIE
REAL(DP) ELEMENTAL FUNCTION DAIE(X)
  !> Calculate the Airy function for a negative argument and an
  !  exponentially scaled Airy function for a non-negative argument.
  !***
  ! **Library:**   SLATEC (FNLIB)
  !***
  ! **Category:**  C10D
  !***
  ! **Type:**      DOUBLE PRECISION (AIE-S, DAIE-D)
  !***
  ! **Keywords:**  EXPONENTIALLY SCALED AIRY FUNCTION, FNLIB, SPECIAL FUNCTIONS
  !***
  ! **Author:**  Fullerton, W., (LANL)
  !***
  ! **Description:**
  !
  ! DAIE(X) calculates the Airy function or the exponentially scaled
  ! Airy function depending on the value of the argument.  The function
  ! and argument are both double precision.
  !
  ! Evaluate AI(X) for X <= 0.0 and AI(X)*EXP(ZETA) where
  ! ZETA = 2/3 * X**(3/2)  for X >= 0.0
  !
  ! Series for AIF        on the interval -1.00000E+00 to  1.00000E+00
  !                                        with weighted error   8.37E-33
  !                                         log weighted error  32.08
  !                               significant figures required  30.87
  !                                    decimal places required  32.63
  !
  ! Series for AIG        on the interval -1.00000E+00 to  1.00000E+00
  !                                        with weighted error   7.47E-34
  !                                         log weighted error  33.13
  !                               significant figures required  31.50
  !                                    decimal places required  33.68
  !
  ! Series for AIP1       on the interval  1.25000E-01 to  1.00000E+00
  !                                        with weighted error   3.69E-32
  !                                         log weighted error  31.43
  !                               significant figures required  29.55
  !                                    decimal places required  32.31
  !
  ! Series for AIP2       on the interval  0.          to  1.25000E-01
  !                                        with weighted error   3.48E-32
  !                                         log weighted error  31.46
  !                               significant figures required  28.74
  !                                    decimal places required  32.24
  !
  !***
  ! **References:**  (NONE)
  !***
  ! **Routines called:**  D1MACH, D9AIMP, DCSEVL, INITDS

  !* REVISION HISTORY  (YYMMDD)
  !   770701  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   890531  REVISION DATE from Version 3.2
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   920618  Removed space from variable names.  (RWC, WRB)
  USE service, ONLY : eps_2_dp, huge_dp
  !
  REAL(DP), INTENT(IN) :: X
  !
  REAL(DP) :: sqrtx, theta, xm, z
  INTEGER, PARAMETER :: naif = 8, naig = 8, naip1 = 26, naip2 = 15
  REAL(DP), PARAMETER :: eta = 0.1_DP*eps_2_dp, x3sml = eta**0.3333_SP, &
    x32sml = 1.3104_DP*x3sml**2, xbig = huge_dp**0.6666_DP
  REAL(DP), PARAMETER :: aifcs(13) = [ -.37971358496669997496197089469414E-1_DP, &
    +.59191888537263638574319728013777E-1_DP, +.98629280577279975365603891044060E-3_DP, &
    +.68488438190765667554854830182412E-5_DP, +.25942025962194713019489279081403E-7_DP, &
    +.61766127740813750329445749697236E-10_DP, +.10092454172466117901429556224601E-12_DP, &
    +.12014792511179938141288033225333E-15_DP, +.10882945588716991878525295466666E-18_DP, &
    +.77513772196684887039238400000000E-22_DP, +.44548112037175638391466666666666E-25_DP, &
    +.21092845231692343466666666666666E-28_DP, +.83701735910741333333333333333333E-32_DP ]
  REAL(DP), PARAMETER :: aigcs(13) = [ +.18152365581161273011556209957864E-1_DP, &
    +.21572563166010755534030638819968E-1_DP, +.25678356987483249659052428090133E-3_DP, &
    +.14265214119792403898829496921721E-5_DP, +.45721149200180426070434097558191E-8_DP, &
    +.95251708435647098607392278840592E-11_DP, +.13925634605771399051150420686190E-13_DP, &
    +.15070999142762379592306991138666E-16_DP, +.12559148312567778822703205333333E-19_DP, &
    +.83063073770821340343829333333333E-23_DP, +.44657538493718567445333333333333E-26_DP, &
    +.19900855034518869333333333333333E-29_DP, +.74702885256533333333333333333333E-33_DP ]
  REAL(DP), PARAMETER :: aip1cs(57) = [ -.2146951858910538455460863467778E-1_DP, &
    -.7535382535043301166219720865565E-2_DP, +.5971527949026380852035388881994E-3_DP, &
    -.7283251254207610648502368291548E-4_DP, +.1110297130739299666517381821140E-4_DP, &
    -.1950386152284405710346930314033E-5_DP, +.3786973885159515193885319670057E-6_DP, &
    -.7929675297350978279039072879154E-7_DP, +.1762247638674256075568420122202E-7_DP, &
    -.4110767539667195045029896593893E-8_DP, +.9984770057857892247183414107544E-9_DP, &
    -.2510093251387122211349867730034E-9_DP, +.6500501929860695409272038601725E-10_DP, &
    -.1727818405393616515478877107366E-10_DP, +.4699378842824512578362292872307E-11_DP, &
    -.1304675656297743914491241246272E-11_DP, +.3689698478462678810473948382282E-12_DP, &
    -.1061087206646806173650359679035E-12_DP, +.3098414384878187438660210070110E-13_DP, &
    -.9174908079824139307833423547851E-14_DP, +.2752049140347210895693579062271E-14_DP, &
    -.8353750115922046558091393301880E-15_DP, +.2563931129357934947568636168612E-15_DP, &
    -.7950633762598854983273747289822E-16_DP, +.2489283634603069977437281175644E-16_DP, &
    -.7864326933928735569664626221296E-17_DP, +.2505687311439975672324470645019E-17_DP, &
    -.8047420364163909524537958682241E-18_DP, +.2604097118952053964443401104392E-18_DP, &
    -.8486954164056412259482488834184E-19_DP, +.2784706882142337843359429186027E-19_DP, &
    -.9195858953498612913687224151354E-20_DP, +.3055304318374238742247668225583E-20_DP, &
    -.1021035455479477875902177048439E-20_DP, +.3431118190743757844000555680836E-21_DP, &
    -.1159129341797749513376922463109E-21_DP, +.3935772844200255610836268229154E-22_DP, &
    -.1342880980296717611956718989038E-22_DP, +.4603287883520002741659190305314E-23_DP, &
    -.1585043927004064227810772499387E-23_DP, +.5481275667729675908925523755008E-24_DP, &
    -.1903349371855047259064017948945E-24_DP, +.6635682302374008716777612115968E-25_DP, &
    -.2322311650026314307975200986453E-25_DP, +.8157640113429179313142743695359E-26_DP, &
    -.2875824240632900490057489929557E-26_DP, +.1017329450942901435079714319018E-26_DP, &
    -.3610879108742216446575703490559E-27_DP, +.1285788540363993421256640342698E-27_DP, &
    -.4592901037378547425160693022719E-28_DP, +.1645597033820713725812102485333E-28_DP, &
    -.5913421299843501842087920271360E-29_DP, +.2131057006604993303479369509546E-29_DP, &
    -.7701158157787598216982761745066E-30_DP, +.2790533307968930417581783777280E-30_DP, &
    -.1013807715111284006452241367039E-30_DP, +.3692580158719624093658286216533E-31_DP ]
  REAL(DP), PARAMETER :: aip2cs(37) = [ -.174314496929375513390355844011E-2_DP, &
    -.167893854325541671632190613480E-2_DP, +.359653403352166035885983858114E-4_DP, &
    -.138081860273922835457399383100E-5_DP, +.741122807731505298848699095233E-7_DP, &
    -.500238203900133013130422866325E-8_DP, +.400693917417184240675446866355E-9_DP, &
    -.367331242795905044199318496207E-10_DP, +.376034439592373852439592002918E-11_DP, &
    -.422321332718747538026564938968E-12_DP, +.513509454033657070919618754120E-13_DP, &
    -.669095850390477595651681356676E-14_DP, +.926667545641290648239550724382E-15_DP, &
    -.135514382416070576333397356591E-15_DP, +.208115496312830995299006549335E-16_DP, &
    -.334116499159176856871277570256E-17_DP, +.558578584585924316868032946585E-18_DP, &
    -.969219040152365247518658209109E-19_DP, +.174045700128893206465696557738E-19_DP, &
    -.322640979731130400247846333098E-20_DP, +.616074471106625258533259618986E-21_DP, &
    -.120936347982490059076420676266E-21_DP, +.243632763310138108261570095786E-22_DP, &
    -.502914221497457468943403144533E-23_DP, +.106224175543635689495470626133E-23_DP, &
    -.229284284895989241509856324266E-24_DP, +.505181733929503744986884778666E-25_DP, &
    -.113498123714412404979793920000E-25_DP, +.259765565985606980698374144000E-26_DP, &
    -.605124621542939506172231679999E-27_DP, +.143359777966772800720295253333E-27_DP, &
    -.345147757060899986280721066666E-28_DP, +.843875190213646740427025066666E-29_DP, &
    -.209396142298188169434453333333E-29_DP, +.527008873478945503182848000000E-30_DP, &
    -.134457433014553385789030399999E-30_DP, +.347570964526601147340117333333E-31_DP ]
  !* FIRST EXECUTABLE STATEMENT  DAIE
  ! naif = INITDS(aifcs,eta)
  ! naig = INITDS(aigcs,eta)
  ! naip1 = INITDS(aip1cs,eta)
  ! naip2 = INITDS(aip2cs,eta)
  !
  IF( X<(-1._DP) ) THEN
    CALL D9AIMP(X,xm,theta)
    DAIE = xm*COS(theta)
  ELSEIF( X<=1._DP ) THEN
    z = 0._DP
    IF( ABS(X)>x3sml ) z = X**3
    DAIE = 0.375_DP + (DCSEVL(z,aifcs(1:naif))-X*(0.25_DP+DCSEVL(z,aigcs(1:naig))))
    IF( X>x32sml ) DAIE = DAIE*EXP(2._DP*X*SQRT(X)/3._DP)
  ELSEIF( X<=4._DP ) THEN
    sqrtx = SQRT(X)
    z = (16._DP/(X*sqrtx)-9._DP)/7._DP
    DAIE = (0.28125_DP+DCSEVL(z,aip1cs(1:naip1)))/SQRT(sqrtx)
  ELSE
    sqrtx = SQRT(X)
    z = -1._DP
    IF( X<xbig ) z = 16._DP/(X*sqrtx) - 1._DP
    DAIE = (0.28125_DP+DCSEVL(z,aip2cs(1:naip2)))/SQRT(sqrtx)
  END IF

  RETURN
END FUNCTION DAIE