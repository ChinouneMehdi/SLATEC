!** DBIE
REAL(DP) FUNCTION DBIE(X)
  !> Calculate the Bairy function for a negative argument and an
  !            exponentially scaled Bairy function for a non-negative
  !            argument.
  !***
  ! **Library:**   SLATEC (FNLIB)
  !***
  ! **Category:**  C10D
  !***
  ! **Type:**      DOUBLE PRECISION (BIE-S, DBIE-D)
  !***
  ! **Keywords:**  BAIRY FUNCTION, EXPONENTIALLY SCALED, FNLIB,
  !             SPECIAL FUNCTIONS
  !***
  ! **Author:**  Fullerton, W., (LANL)
  !***
  ! **Description:**
  !
  ! DBIE(X) calculates the double precision Airy function of the
  ! second kind or the double precision exponentially scaled Airy
  ! function of the second kind, depending on the value of the
  ! double precision argument X.
  !
  ! Evaluate BI(X) for X <= 0.0  and  BI(X)*EXP(-ZETA)  where
  ! ZETA = 2/3 * X**(3/2)  for X >= 0.0
  !
  !
  ! Series for BIF        on the interval -1.00000E+00 to  1.00000E+00
  !                                        with weighted error   1.45E-32
  !                                         log weighted error  31.84
  !                               significant figures required  30.85
  !                                    decimal places required  32.40
  !
  !
  ! Series for BIG        on the interval -1.00000E+00 to  1.00000E+00
  !                                        with weighted error   1.29E-33
  !                                         log weighted error  32.89
  !                               significant figures required  31.48
  !                                    decimal places required  33.45
  !
  !
  ! Series for BIF2       on the interval  1.00000E+00 to  8.00000E+00
  !                                        with weighted error   6.08E-32
  !                                         log weighted error  31.22
  !                        approx significant figures required  30.8
  !                                    decimal places required  31.80
  !
  !
  ! Series for BIG2       on the interval  1.00000E+00 to  8.00000E+00
  !                                        with weighted error   4.91E-33
  !                                         log weighted error  32.31
  !                        approx significant figures required  31.6
  !                                    decimal places required  32.90
  !
  !
  ! Series for BIP1       on the interval  1.25000E-01 to  3.53553E-01
  !                                        with weighted error   1.06E-32
  !                                         log weighted error  31.98
  !                               significant figures required  30.61
  !                                    decimal places required  32.81
  !
  !
  ! Series for BIP2       on the interval  0.          to  1.25000E-01
  !                                        with weighted error   4.04E-33
  !                                         log weighted error  32.39
  !                               significant figures required  31.15
  !                                    decimal places required  33.37
  !
  !***
  ! **References:**  (NONE)
  !***
  ! **Routines called:**  D1MACH, D9AIMP, DCSEVL, INITDS

  !* REVISION HISTORY  (YYMMDD)
  !   770701  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   890531  REVISION DATE from Version 3.2
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  USE service, ONLY : D1MACH
  REAL(DP) :: X
  REAL(DP) :: sqrtx, theta, xm, z
  INTEGER, SAVE :: nbif, nbig, nbif2, nbig2, nbip1, nbip2
  REAL(DP), PARAMETER :: eta = 0.1_DP*D1MACH(3), x3sml = eta**0.3333_DP, &
    x32sml = 1.3104_DP*x3sml**2, xbig = D1MACH(2)**0.6666_DP
  REAL(DP), PARAMETER :: bifcs(13) = [ -.16730216471986649483537423928176E-1_DP, &
    +.10252335834249445611426362777757E+0_DP, +.17083092507381516539429650242013E-2_DP, &
    +.11862545467744681179216459210040E-4_DP, +.44932907017792133694531887927242E-7_DP, &
    +.10698207143387889067567767663628E-9_DP, +.17480643399771824706010517628573E-12_DP, &
    +.20810231071761711025881891834399E-15_DP, +.18849814695665416509927971733333E-18_DP, &
    +.13425779173097804625882666666666E-21_DP, +.77159593429658887893333333333333E-25_DP, &
    +.36533879617478566399999999999999E-28_DP, +.14497565927953066666666666666666E-31_DP ]
  REAL(DP), PARAMETER :: bigcs(13) = [ +.22466223248574522283468220139024E-1_DP, &
    +.37364775453019545441727561666752E-1_DP, +.44476218957212285696215294326639E-3_DP, &
    +.24708075636329384245494591948882E-5_DP, +.79191353395149635134862426285596E-8_DP, &
    +.16498079851827779880887872402706E-10_DP, +.24119906664835455909247501122841E-13_DP, &
    +.26103736236091436985184781269333E-16_DP, +.21753082977160323853123792000000E-19_DP, &
    +.14386946400390433219483733333333E-22_DP, +.77349125612083468629333333333333E-26_DP, &
    +.34469292033849002666666666666666E-29_DP, +.12938919273216000000000000000000E-32_DP ]
  REAL(DP), PARAMETER :: bif2cs(15) = [ +.0998457269381604104468284257993E+0_DP, &
    +.47862497786300553772211467318231E+0_DP, +.25155211960433011771324415436675E-1_DP, &
    +.58206938852326456396515697872216E-3_DP, +.74997659644377865943861457378217E-5_DP, &
    +.61346028703493836681403010356474E-7_DP, +.34627538851480632900434268733359E-9_DP, &
    +.14288910080270254287770846748931E-11_DP, +.44962704298334641895056472179200E-14_DP, &
    +.11142323065833011708428300106666E-16_DP, +.22304791066175002081517866666666E-19_DP, &
    +.36815778736393142842922666666666E-22_DP, +.50960868449338261333333333333333E-25_DP, &
    +.60003386926288554666666666666666E-28_DP, +.60827497446570666666666666666666E-31_DP ]
  REAL(DP), PARAMETER :: big2cs(15) = [ +.033305662145514340465176188111647E+0_DP, &
    +.161309215123197067613287532084943E+0_DP, +.631900730961342869121615634921173E-2_DP, &
    +.118790456816251736389780192304567E-3_DP, +.130453458862002656147116485012843E-5_DP, &
    +.937412599553521729546809615508936E-8_DP, +.474580188674725153788510169834595E-10_DP, &
    +.178310726509481399800065667560946E-12_DP, +.516759192784958180374276356640000E-15_DP, &
    +.119004508386827125129496251733333E-17_DP, +.222982880666403517277063466666666E-20_DP, &
    +.346551923027689419722666666666666E-23_DP, +.453926336320504514133333333333333E-26_DP, &
    +.507884996513522346666666666666666E-29_DP, +.491020674696533333333333333333333E-32_DP ]
  REAL(DP), PARAMETER :: bip1cs(47) = [ -.83220474779434474687471864707973E-1_DP, &
    +.11461189273711742889920226128031E-1_DP, +.42896440718911509494134472566635E-3_DP, &
    -.14906639379950514017847677732954E-3_DP, -.13076597267876290663136340998881E-4_DP, &
    +.63275983961030344754535716032494E-5_DP, -.42226696982681924884778515889433E-6_DP, &
    -.19147186298654689632835494181277E-6_DP, +.64531062845583173611038157880934E-7_DP, &
    -.78448546771397719289748310448628E-8_DP, -.96077216623785085879198533565432E-9_DP, &
    +.70004713316443966339006074402068E-9_DP, -.17731789132814932022083128056698E-9_DP, &
    +.22720894783465236347282126389311E-10_DP, +.16540456313972049847032860681891E-11_DP, &
    -.18517125559292316390755369896693E-11_DP, +.59576312477117290165680715534277E-12_DP, &
    -.12194348147346564781055769498986E-12_DP, +.13347869253513048815386347813597E-13_DP, &
    +.17278311524339746664384792889731E-14_DP, -.14590732013016720735268871713166E-14_DP, &
    +.49010319927115819978994989520104E-15_DP, -.11556545519261548129262972762521E-15_DP, &
    +.19098807367072411430671732441524E-16_DP, -.11768966854492179886913995957862E-17_DP, &
    -.63271925149530064474537459677047E-18_DP, +.33861838880715361614130191322316E-18_DP, &
    -.10725825321758625254992162219622E-18_DP, +.25995709605617169284786933115562E-19_DP, &
    -.48477583571081193660962309494101E-20_DP, +.55298913982121625361505513198933E-21_DP, &
    +.49421660826069471371748197444266E-22_DP, -.55162121924145707458069720814933E-22_DP, &
    +.21437560417632550086631884499626E-22_DP, -.61910313387655605798785061137066E-23_DP, &
    +.14629362707391245659830967336959E-23_DP, -.27918484471059005576177866069333E-24_DP, &
    +.36455703168570246150906795349333E-25_DP, +.58511821906188711839382459733333E-27_DP, &
    -.24946950487566510969745047551999E-26_DP, +.10979323980338380977919579477333E-26_DP, &
    -.34743388345961115015034088106666E-27_DP, +.91373402635349697363171082240000E-28_DP, &
    -.20510352728210629186247720959999E-28_DP, +.37976985698546461748651622399999E-29_DP, &
    -.48479458497755565887848448000000E-30_DP, -.10558306941230714314205866666666E-31_DP ]
  REAL(DP), PARAMETER :: bip2cs(88) = [ -.11359673758598867913797310895527E+0_DP, &
    +.41381473947881595760052081171444E-2_DP, +.13534706221193329857696921727508E-3_DP, &
    +.10427316653015353405887183456780E-4_DP, +.13474954767849907889589911958925E-5_DP, &
    +.16965374054383983356062511163756E-6_DP, -.10096500865641624301366228396373E-7_DP, &
    -.16729119493778475127836973095943E-7_DP, -.45815364485068383217152795613391E-8_DP, &
    +.37366813665655477274064749384284E-9_DP, +.57669303201452448119584643502111E-9_DP, &
    +.62181265087850324095393408792371E-10_DP, -.63294120282743068241589177281354E-10_DP, &
    -.14915047908598767633999091989487E-10_DP, +.78896213942486771938172394294891E-11_DP, &
    +.24960513721857797984888064000127E-11_DP, -.12130075287291659477746664734814E-11_DP, &
    -.37404939108727277887343460402716E-12_DP, +.22377278140321476798783446931091E-12_DP, &
    +.47490296312192466341986077472514E-13_DP, -.45261607991821224810605655831294E-13_DP, &
    -.30172271841986072645112245876020E-14_DP, +.91058603558754058327592683478908E-14_DP, &
    -.98149238033807062926643864207709E-15_DP, -.16429400647889465253601245251589E-14_DP, &
    +.55334834214274215451182114635164E-15_DP, +.21750479864482655984374381998156E-15_DP, &
    -.17379236200220656971287029558087E-15_DP, -.10470023471443714959283909313604E-17_DP, &
    +.39219145986056386925441403311462E-16_DP, -.11621293686345196925824005665910E-16_DP, &
    -.54027474491754245533735411307773E-17_DP, +.45441582123884610882675428553304E-17_DP, &
    -.28775599625221075729427585480086E-18_DP, -.10017340927225341243596162960440E-17_DP, &
    +.44823931215068369856332561906313E-18_DP, +.76135968654908942328948982366775E-19_DP, &
    -.14448324094881347238956060145422E-18_DP, +.40460859449205362251624847392112E-19_DP, &
    +.20321085700338446891325190707277E-19_DP, -.19602795471446798718272758041962E-19_DP, &
    +.34273038443944824263518958211738E-20_DP, +.37023705853905135480024651593154E-20_DP, &
    -.26879595172041591131400332966712E-20_DP, +.28121678463531712209714454683364E-21_DP, &
    +.60933963636177797173271119680329E-21_DP, -.38666621897150844994172977893413E-21_DP, &
    +.25989331253566943450895651927228E-22_DP, +.97194393622938503767281175216084E-22_DP, &
    -.59392817834375098415630478204591E-22_DP, +.38864949977113015409591960439444E-23_DP, &
    +.15334307393617272869721512868769E-22_DP, -.97513555209762624036336521409724E-23_DP, &
    +.96340644440489471424741339383726E-24_DP, +.23841999400208880109946748792454E-23_DP, &
    -.16896986315019706184848044205207E-23_DP, +.27352715888928361222578444801478E-24_DP, &
    +.35660016185409578960111685025730E-24_DP, -.30234026608258827249534280666954E-24_DP, &
    +.75002041605973930653144204823232E-25_DP, +.48403287575851388827455319838748E-25_DP, &
    -.54364137654447888432698010297766E-25_DP, +.19281214470820962653345978809756E-25_DP, &
    +.50116355020532656659611814172172E-26_DP, -.95040744582693253786034620869972E-26_DP, &
    +.46372646157101975948696332245611E-26_DP, +.21177170704466954163768170577046E-28_DP, &
    -.15404850268168594303692204548726E-26_DP, +.10387944293201213662047889194441E-26_DP, &
    -.19890078156915416751316728235153E-27_DP, -.21022173878658495471177044522532E-27_DP, &
    +.21353099724525793150633356670491E-27_DP, -.79040810747961342319023537632627E-28_DP, &
    -.16575359960435585049973741763592E-28_DP, +.38868342850124112587625586496537E-28_DP, &
    -.22309237330896866182621562424717E-28_DP, +.27777244420176260265625977404382E-29_DP, &
    +.57078543472657725368712433782772E-29_DP, -.51743084445303852800173371555280E-29_DP, &
    +.18413280751095837198450927071569E-29_DP, +.44422562390957094598544071068647E-30_DP, &
    -.98504142639629801547464958226943E-30_DP, +.58857201353585104884754198881995E-30_DP, &
    -.97636075440429787961402312628595E-31_DP, -.13581011996074695047063597884122E-30_DP, &
    +.13999743518492413270568048380345E-30_DP, -.59754904545248477620884562981118E-31_DP, &
    -.40391653875428313641045327529856E-32_DP ]
  REAL(DP), PARAMETER :: atr = 8.75069057084843450880771988210148_DP
  REAL(DP), PARAMETER :: btr = -2.09383632135605431360096498526268_DP
  LOGICAL, SAVE :: first = .TRUE.
  !* FIRST EXECUTABLE STATEMENT  DBIE
  IF( first ) THEN
    nbif = INITDS(bifcs,13,eta)
    nbig = INITDS(bigcs,13,eta)
    nbif2 = INITDS(bif2cs,15,eta)
    nbig2 = INITDS(big2cs,15,eta)
    nbip1 = INITDS(bip1cs,47,eta)
    nbip2 = INITDS(bip2cs,88,eta)
    first = .FALSE.
  END IF
  !
  IF( X<(-1._DP) ) THEN
    CALL D9AIMP(X,xm,theta)
    DBIE = xm*SIN(theta)
    RETURN
    !
  ELSEIF( X<=1._DP ) THEN
    z = 0._DP
    IF( ABS(X)>x3sml ) z = X**3
    DBIE = 0.625_DP + DCSEVL(z,bifcs,nbif)&
      + X*(0.4375_DP+DCSEVL(z,bigcs,nbig))
    IF( X>x32sml ) DBIE = DBIE*EXP(-2._DP*X*SQRT(X)/3._DP)
    RETURN
    !
  ELSEIF( X<=2._DP ) THEN
    z = (2._DP*X**3-9._DP)/7._DP
    DBIE = EXP(-2._DP*X*SQRT(X)/3._DP)&
      *(1.125_DP+DCSEVL(z,bif2cs,nbif2)+X*(0.625_DP+DCSEVL(z,big2cs,nbig2)))
    RETURN
    !
  ELSEIF( X>4._DP ) THEN
    !
    sqrtx = SQRT(X)
    z = -1._DP
    IF( X<xbig ) z = 16._DP/(X*sqrtx) - 1._DP
    DBIE = (0.625_DP+DCSEVL(z,bip2cs,nbip2))/SQRT(sqrtx)
    RETURN
  END IF
  sqrtx = SQRT(X)
  z = atr/(X*sqrtx) + btr
  DBIE = (0.625_DP+DCSEVL(z,bip1cs,nbip1))/SQRT(sqrtx)
  RETURN
END FUNCTION DBIE
