!** DFAC
REAL(DP) FUNCTION DFAC(N)
  !> Compute the factorial function.
  !***
  ! **Library:**   SLATEC (FNLIB)
  !***
  ! **Category:**  C1
  !***
  ! **Type:**      DOUBLE PRECISION (FAC-S, DFAC-D)
  !***
  ! **Keywords:**  FACTORIAL, FNLIB, SPECIAL FUNCTIONS
  !***
  ! **Author:**  Fullerton, W., (LANL)
  !***
  ! **Description:**
  !
  ! DFAC(N) calculates the double precision factorial for integer
  ! argument N.
  !
  !***
  ! **References:**  (NONE)
  !***
  ! **Routines called:**  D9LGMC, DGAMLM, XERMSG

  !* REVISION HISTORY  (YYMMDD)
  !   770601  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   890531  REVISION DATE from Version 3.2
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
  USE service, ONLY : XERMSG
  INTEGER :: N
  REAL(DP) :: x, xmax, xmin
  REAL(DP), PARAMETER :: facn(31) = [ +.100000000000000000000000000000000E+1_DP, &
    +.100000000000000000000000000000000E+1_DP, +.200000000000000000000000000000000E+1_DP, &
    +.600000000000000000000000000000000E+1_DP, +.240000000000000000000000000000000E+2_DP, &
    +.120000000000000000000000000000000E+3_DP, +.720000000000000000000000000000000E+3_DP, &
    +.504000000000000000000000000000000E+4_DP, +.403200000000000000000000000000000E+5_DP, &
    +.362880000000000000000000000000000E+6_DP, +.362880000000000000000000000000000E+7_DP, &
    +.399168000000000000000000000000000E+8_DP, +.479001600000000000000000000000000E+9_DP, &
    +.622702080000000000000000000000000E+10_DP, +.871782912000000000000000000000000E+11_DP, &
    +.130767436800000000000000000000000E+13_DP, +.209227898880000000000000000000000E+14_DP, &
    +.355687428096000000000000000000000E+15_DP, +.640237370572800000000000000000000E+16_DP, &
    +.121645100408832000000000000000000E+18_DP, +.243290200817664000000000000000000E+19_DP, &
    +.510909421717094400000000000000000E+20_DP, +.112400072777760768000000000000000E+22_DP, &
    +.258520167388849766400000000000000E+23_DP, +.620448401733239439360000000000000E+24_DP, &
    +.155112100433309859840000000000000E+26_DP, +.403291461126605635584000000000000E+27_DP, &
    +.108888694504183521607680000000000E+29_DP, +.304888344611713860501504000000000E+30_DP, &
    +.884176199373970195454361600000000E+31_DP, +.265252859812191058636308480000000E+33_DP ]
  REAL(DP), PARAMETER :: sq2pil = 0.91893853320467274178032973640562_DP
  INTEGER, SAVE :: nmax = 0
  !* FIRST EXECUTABLE STATEMENT  DFAC
  IF( nmax==0 ) THEN
    CALL DGAMLM(xmin,xmax)
    nmax = INT( xmax ) - 1
  END IF
  !
  IF( N<0 ) CALL XERMSG('DFAC','FACTORIAL OF NEGATIVE INTEGER UNDEFINED',1,2)
  !
  IF( N<=30 ) DFAC = facn(N+1)
  IF( N<=30 ) RETURN
  !
  IF( N>nmax ) CALL XERMSG('DFAC','N SO BIG FACTORIAL(N) OVERFLOWS',2,2)
  !
  x = N + 1
  DFAC = EXP((x-0.5_DP)*LOG(x)-x+sq2pil+D9LGMC(x))
  !
END FUNCTION DFAC
