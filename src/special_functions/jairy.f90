!** JAIRY
SUBROUTINE JAIRY(X,Rx,C,Ai,Dai)
  !> Subsidiary to BESJ and BESY
  !***
  ! **Library:**   SLATEC
  !***
  ! **Type:**      SINGLE PRECISION (JAIRY-S, DJAIRY-D)
  !***
  ! **Author:**  Amos, D. E., (SNLA)
  !           Daniel, S. L., (SNLA)
  !           Weston, M. K., (SNLA)
  !***
  ! **Description:**
  !
  !                  JAIRY computes the Airy function AI(X)
  !                   and its derivative DAI(X) for ASYJY
  !
  !                                   INPUT
  !
  !         X - Argument, computed by ASYJY, X unrestricted
  !        RX - RX=SQRT(ABS(X)), computed by ASYJY
  !         C - C=2.*(ABS(X)**1.5)/3., computed by ASYJY
  !
  !                                  OUTPUT
  !
  !        AI - Value of function AI(X)
  !       DAI - Value of the derivative DAI(X)
  !
  !***
  ! **See also:**  BESJ, BESY
  !***
  ! **Routines called:**  (NONE)

  !* REVISION HISTORY  (YYMMDD)
  !   750101  DATE WRITTEN
  !   891009  Removed unreferenced variable.  (WRB)
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   900328  Added TYPE section.  (WRB)
  !   910408  Updated the AUTHOR section.  (WRB)

  !
  REAL(SP) :: Ai, C, Dai, Rx, X
  INTEGER :: i, j
  REAL(SP) :: ccv, cv, ec, e1, e2, f1, f2, rtrx, scv, t, temp1, temp2, tt
  INTEGER, PARAMETER :: n1 = 14, n2 = 23, n3 = 19, n4 = 15
  INTEGER, PARAMETER :: m1 = 12, m2 = 21, m3 = 17, m4 = 13
  INTEGER, PARAMETER :: n1d = 14, n2d = 24, n3d = 19, n4d = 15
  INTEGER, PARAMETER :: m1d = 12, m2d = 22, m3d = 17, m4d = 13
  REAL(SP), PARAMETER :: fpi12 = 1.30899693899575E+00_SP, con2 = 5.03154716196777E+00_SP, &
    con3 = 3.80004589867293E-01_SP, con4 = 8.33333333333333E-01_SP, &
    con5 = 8.66025403784439E-01_SP
  REAL(SP), PARAMETER :: ak1(14) = [ 2.20423090987793E-01_SP, -1.25290242787700E-01_SP, &
    1.03881163359194E-02_SP, 8.22844152006343E-04_SP, -2.34614345891226E-04_SP, &
    1.63824280172116E-05_SP, 3.06902589573189E-07_SP, -1.29621999359332E-07_SP, &
    8.22908158823668E-09_SP, 1.53963968623298E-11_SP, -3.39165465615682E-11_SP, &
    2.03253257423626E-12_SP, -1.10679546097884E-14_SP, -5.16169497785080E-15_SP ]
  REAL(SP), PARAMETER :: ak2(23) = [ 2.74366150869598E-01_SP, 5.39790969736903E-03_SP, &
    -1.57339220621190E-03_SP, 4.27427528248750E-04_SP, -1.12124917399925E-04_SP, &
    2.88763171318904E-05_SP, -7.36804225370554E-06_SP, 1.87290209741024E-06_SP, &
    -4.75892793962291E-07_SP, 1.21130416955909E-07_SP, -3.09245374270614E-08_SP, &
    7.92454705282654E-09_SP, -2.03902447167914E-09_SP, 5.26863056595742E-10_SP, &
    -1.36704767639569E-10_SP, 3.56141039013708E-11_SP, -9.31388296548430E-12_SP, &
    2.44464450473635E-12_SP, -6.43840261990955E-13_SP, 1.70106030559349E-13_SP, &
    -4.50760104503281E-14_SP, 1.19774799164811E-14_SP, -3.19077040865066E-15_SP ]
  REAL(SP), PARAMETER :: ak3(14) = [ 2.80271447340791E-01_SP, -1.78127042844379E-03_SP, &
  4.03422579628999E-05_SP, -1.63249965269003E-06_SP, 9.21181482476768E-08_SP, &
  -6.52294330229155E-09_SP, 5.47138404576546E-10_SP, -5.24408251800260E-11_SP, &
  5.60477904117209E-12_SP, -6.56375244639313E-13_SP, 8.31285761966247E-14_SP, &
  -1.12705134691063E-14_SP, 1.62267976598129E-15_SP, -2.46480324312426E-16_SP ]
  REAL(SP), PARAMETER :: ajp(19) = [ 7.78952966437581E-02_SP, -1.84356363456801E-01_SP, &
    3.01412605216174E-02_SP, 3.05342724277608E-02_SP, -4.95424702513079E-03_SP, &
    -1.72749552563952E-03_SP, 2.43137637839190E-04_SP, 5.04564777517082E-05_SP, &
    -6.16316582695208E-06_SP, -9.03986745510768E-07_SP, 9.70243778355884E-08_SP, &
    1.09639453305205E-08_SP, -1.04716330588766E-09_SP, -9.60359441344646E-11_SP, &
    8.25358789454134E-12_SP, 6.36123439018768E-13_SP, -4.96629614116015E-14_SP, &
    -3.29810288929615E-15_SP, 2.35798252031104E-16_SP ]
  REAL(SP), PARAMETER :: ajn(19) = [ 3.80497887617242E-02_SP, -2.45319541845546E-01_SP, &
    1.65820623702696E-01_SP, 7.49330045818789E-02_SP, -2.63476288106641E-02_SP, &
    -5.92535597304981E-03_SP, 1.44744409589804E-03_SP, 2.18311831322215E-04_SP, &
    -4.10662077680304E-05_SP, -4.66874994171766E-06_SP, 7.15218807277160E-07_SP, &
    6.52964770854633E-08_SP, -8.44284027565946E-09_SP, -6.44186158976978E-10_SP, &
    7.20802286505285E-11_SP, 4.72465431717846E-12_SP, -4.66022632547045E-13_SP, &
    -2.67762710389189E-14_SP, 2.36161316570019E-15_SP ]
  REAL(SP), PARAMETER :: a(15) = [ 4.90275424742791E-01_SP, 1.57647277946204E-03_SP, &
    -9.66195963140306E-05_SP, 1.35916080268815E-07_SP, 2.98157342654859E-07_SP, &
    -1.86824767559979E-08_SP, -1.03685737667141E-09_SP, 3.28660818434328E-10_SP, &
    -2.57091410632780E-11_SP, -2.32357655300677E-12_SP, 9.57523279048255E-13_SP, &
    -1.20340828049719E-13_SP, -2.90907716770715E-15_SP, 4.55656454580149E-15_SP, &
    -9.99003874810259E-16_SP ]
  REAL(SP), PARAMETER :: b(15) = [ 2.78593552803079E-01_SP, -3.52915691882584E-03_SP, &
    -2.31149677384994E-05_SP, 4.71317842263560E-06_SP, -1.12415907931333E-07_SP, &
    -2.00100301184339E-08_SP, 2.60948075302193E-09_SP, -3.55098136101216E-11_SP, &
    -3.50849978423875E-11_SP, 5.83007187954202E-12_SP, -2.04644828753326E-13_SP, &
    -1.10529179476742E-13_SP, 2.87724778038775E-14_SP, -2.88205111009939E-15_SP, &
    -3.32656311696166E-16_SP ]
  REAL(SP), PARAMETER :: dak1(14) = [ 2.04567842307887E-01_SP, -6.61322739905664E-02_SP, &
    -8.49845800989287E-03_SP, 3.12183491556289E-03_SP, -2.70016489829432E-04_SP, &
    -6.35636298679387E-06_SP, 3.02397712409509E-06_SP, -2.18311195330088E-07_SP, &
    -5.36194289332826E-10_SP, 1.13098035622310E-09_SP, -7.43023834629073E-11_SP, &
    4.28804170826891E-13_SP, 2.23810925754539E-13_SP, -1.39140135641182E-14_SP ]
  REAL(SP), PARAMETER :: dak2(24) = [ 2.93332343883230E-01_SP, -8.06196784743112E-03_SP, &
    2.42540172333140E-03_SP, -6.82297548850235E-04_SP, 1.85786427751181E-04_SP, &
    -4.97457447684059E-05_SP, 1.32090681239497E-05_SP, -3.49528240444943E-06_SP, &
    9.24362451078835E-07_SP, -2.44732671521867E-07_SP, 6.49307837648910E-08_SP, &
    -1.72717621501538E-08_SP, 4.60725763604656E-09_SP, -1.23249055291550E-09_SP, &
    3.30620409488102E-10_SP, -8.89252099772401E-11_SP, 2.39773319878298E-11_SP, &
    -6.48013921153450E-12_SP, 1.75510132023731E-12_SP, -4.76303829833637E-13_SP, &
    1.29498241100810E-13_SP, -3.52679622210430E-14_SP, 9.62005151585923E-15_SP, &
    -2.62786914342292E-15_SP ]
  REAL(SP), PARAMETER :: dak3(14) = [ 2.84675828811349E-01_SP, 2.53073072619080E-03_SP, &
    -4.83481130337976E-05_SP, 1.84907283946343E-06_SP, -1.01418491178576E-07_SP, &
    7.05925634457153E-09_SP, -5.85325291400382E-10_SP, 5.56357688831339E-11_SP, &
    -5.90889094779500E-12_SP, 6.88574353784436E-13_SP, -8.68588256452194E-14_SP, &
    1.17374762617213E-14_SP, -1.68523146510923E-15_SP, 2.55374773097056E-16_SP ]
  REAL(SP), PARAMETER :: dajp(19) = [ 6.53219131311457E-02_SP, -1.20262933688823E-01_SP, &
    9.78010236263823E-03_SP, 1.67948429230505E-02_SP, -1.97146140182132E-03_SP, &
    -8.45560295098867E-04_SP, 9.42889620701976E-05_SP, 2.25827860945475E-05_SP, &
    -2.29067870915987E-06_SP, -3.76343991136919E-07_SP, 3.45663933559565E-08_SP, &
    4.29611332003007E-09_SP, -3.58673691214989E-10_SP, -3.57245881361895E-11_SP, &
    2.72696091066336E-12_SP, 2.26120653095771E-13_SP, -1.58763205238303E-14_SP, &
    -1.12604374485125E-15_SP, 7.31327529515367E-17_SP ]
  REAL(SP), PARAMETER :: dajn(19) = [ 1.08594539632967E-02_SP, 8.53313194857091E-02_SP, &
    -3.15277068113058E-01_SP, -8.78420725294257E-02_SP, 5.53251906976048E-02_SP, &
    9.41674060503241E-03_SP, -3.32187026018996E-03_SP, -4.11157343156826E-04_SP, &
    1.01297326891346E-04_SP, 9.87633682208396E-06_SP, -1.87312969812393E-06_SP, &
    -1.50798500131468E-07_SP, 2.32687669525394E-08_SP, 1.59599917419225E-09_SP, &
    -2.07665922668385E-10_SP, -1.24103350500302E-11_SP, 1.39631765331043E-12_SP, &
    7.39400971155740E-14_SP, -7.32887475627500E-15_SP ]
  REAL(SP), PARAMETER :: da(15) = [ 4.91627321104601E-01_SP, 3.11164930427489E-03_SP, &
    8.23140762854081E-05_SP, -4.61769776172142E-06_SP, -6.13158880534626E-08_SP, &
    2.87295804656520E-08_SP, -1.81959715372117E-09_SP, -1.44752826642035E-10_SP, &
    4.53724043420422E-11_SP, -3.99655065847223E-12_SP, -3.24089119830323E-13_SP, &
    1.62098952568741E-13_SP, -2.40765247974057E-14_SP, 1.69384811284491E-16_SP, &
    8.17900786477396E-16_SP ]
  REAL(SP), PARAMETER :: db(15) = [ -2.77571356944231E-01_SP, 4.44212833419920E-03_SP, &
    -8.42328522190089E-05_SP, -2.58040318418710E-06_SP, 3.42389720217621E-07_SP, &
    -6.24286894709776E-09_SP, -2.36377836844577E-09_SP, 3.16991042656673E-10_SP, &
    -4.40995691658191E-12_SP, -5.18674221093575E-12_SP, 9.64874015137022E-13_SP, &
    -4.90190576608710E-14_SP, -1.77253430678112E-14_SP, 5.55950610442662E-15_SP, &
    -7.11793337579530E-16_SP ]
  !* FIRST EXECUTABLE STATEMENT  JAIRY
  IF( X<0._SP ) THEN
    !
    IF( C>5._SP ) THEN
      !
      t = 10._SP/C - 1._SP
      tt = t + t
      j = n4
      f1 = a(j)
      e1 = b(j)
      f2 = 0._SP
      e2 = 0._SP
      DO i = 1, m4
        j = j - 1
        temp1 = f1
        temp2 = e1
        f1 = tt*f1 - f2 + a(j)
        e1 = tt*e1 - e2 + b(j)
        f2 = temp1
        e2 = temp2
      END DO
      temp1 = t*f1 - f2 + a(1)
      temp2 = t*e1 - e2 + b(1)
      rtrx = SQRT(Rx)
      cv = C - fpi12
      ccv = COS(cv)
      scv = SIN(cv)
      Ai = (temp1*ccv-temp2*scv)/rtrx
      j = n4d
      f1 = da(j)
      e1 = db(j)
      f2 = 0._SP
      e2 = 0._SP
      DO i = 1, m4d
        j = j - 1
        temp1 = f1
        temp2 = e1
        f1 = tt*f1 - f2 + da(j)
        e1 = tt*e1 - e2 + db(j)
        f2 = temp1
        e2 = temp2
      END DO
      temp1 = t*f1 - f2 + da(1)
      temp2 = t*e1 - e2 + db(1)
      e1 = ccv*con5 + 0.5_SP*scv
      e2 = scv*con5 - 0.5_SP*ccv
      Dai = (temp1*e1-temp2*e2)*rtrx
      RETURN
    END IF
  ELSEIF( C>5._SP ) THEN
    !
    t = 10._SP/C - 1._SP
    tt = t + t
    j = n1
    f1 = ak3(j)
    f2 = 0._SP
    DO i = 1, m1
      j = j - 1
      temp1 = f1
      f1 = tt*f1 - f2 + ak3(j)
      f2 = temp1
    END DO
    rtrx = SQRT(Rx)
    ec = EXP(-C)
    Ai = ec*(t*f1-f2+ak3(1))/rtrx
    j = n1d
    f1 = dak3(j)
    f2 = 0._SP
    DO i = 1, m1d
      j = j - 1
      temp1 = f1
      f1 = tt*f1 - f2 + dak3(j)
      f2 = temp1
    END DO
    Dai = -rtrx*ec*(t*f1-f2+dak3(1))
    RETURN
  ELSEIF( X>1.20_SP ) THEN
    !
    t = (X+X-con2)*con3
    tt = t + t
    j = n2
    f1 = ak2(j)
    f2 = 0._SP
    DO i = 1, m2
      j = j - 1
      temp1 = f1
      f1 = tt*f1 - f2 + ak2(j)
      f2 = temp1
    END DO
    rtrx = SQRT(Rx)
    ec = EXP(-C)
    Ai = ec*(t*f1-f2+ak2(1))/rtrx
    j = n2d
    f1 = dak2(j)
    f2 = 0._SP
    DO i = 1, m2d
      j = j - 1
      temp1 = f1
      f1 = tt*f1 - f2 + dak2(j)
      f2 = temp1
    END DO
    Dai = -ec*(t*f1-f2+dak2(1))*rtrx
    RETURN
  ELSE
    t = (X+X-1.2E0_SP)*con4
    tt = t + t
    j = n1
    f1 = ak1(j)
    f2 = 0._SP
    DO i = 1, m1
      j = j - 1
      temp1 = f1
      f1 = tt*f1 - f2 + ak1(j)
      f2 = temp1
    END DO
    Ai = t*f1 - f2 + ak1(1)
    !
    j = n1d
    f1 = dak1(j)
    f2 = 0._SP
    DO i = 1, m1d
      j = j - 1
      temp1 = f1
      f1 = tt*f1 - f2 + dak1(j)
      f2 = temp1
    END DO
    Dai = -(t*f1-f2+dak1(1))
    RETURN
  END IF
  t = 0.4_SP*C - 1._SP
  tt = t + t
  j = n3
  f1 = ajp(j)
  e1 = ajn(j)
  f2 = 0._SP
  e2 = 0._SP
  DO i = 1, m3
    j = j - 1
    temp1 = f1
    temp2 = e1
    f1 = tt*f1 - f2 + ajp(j)
    e1 = tt*e1 - e2 + ajn(j)
    f2 = temp1
    e2 = temp2
  END DO
  Ai = (t*e1-e2+ajn(1)) - X*(t*f1-f2+ajp(1))
  j = n3d
  f1 = dajp(j)
  e1 = dajn(j)
  f2 = 0._SP
  e2 = 0._SP
  DO i = 1, m3d
    j = j - 1
    temp1 = f1
    temp2 = e1
    f1 = tt*f1 - f2 + dajp(j)
    e1 = tt*e1 - e2 + dajn(j)
    f2 = temp1
    e2 = temp2
  END DO
  Dai = X*X*(t*f1-f2+dajp(1)) + (t*e1-e2+dajn(1))
  RETURN
END SUBROUTINE JAIRY
