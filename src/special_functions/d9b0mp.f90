!** D9B0MP
ELEMENTAL SUBROUTINE D9B0MP(X,Ampl,Theta)
  !> Evaluate the modulus and phase for the J0 and Y0 Bessel functions.
  !***
  ! **Library:**   SLATEC (FNLIB)
  !***
  ! **Category:**  C10A1
  !***
  ! **Type:**      DOUBLE PRECISION (D9B0MP-D)
  !***
  ! **Keywords:**  BESSEL FUNCTION, FNLIB, MODULUS, PHASE, SPECIAL FUNCTIONS
  !***
  ! **Author:**  Fullerton, W., (LANL)
  !***
  ! **Description:**
  !
  ! Evaluate the modulus and phase for the Bessel J0 and Y0 functions.
  !
  ! Series for BM0        on the interval  1.56250E-02 to  6.25000E-02
  !                                        with weighted error   4.40E-32
  !                                         log weighted error  31.36
  !                               significant figures required  30.02
  !                                    decimal places required  32.14
  !
  ! Series for BTH0       on the interval  0.          to  1.56250E-02
  !                                        with weighted error   2.66E-32
  !                                         log weighted error  31.57
  !                               significant figures required  30.67
  !                                    decimal places required  32.40
  !
  ! Series for BM02       on the interval  0.          to  1.56250E-02
  !                                        with weighted error   4.72E-32
  !                                         log weighted error  31.33
  !                               significant figures required  30.00
  !                                    decimal places required  32.13
  !
  ! Series for BT02       on the interval  1.56250E-02 to  6.25000E-02
  !                                        with weighted error   2.99E-32
  !                                         log weighted error  31.52
  !                               significant figures required  30.61
  !                                    decimal places required  32.32
  !
  !***
  ! **References:**  (NONE)
  !***
  ! **Routines called:**  D1MACH, DCSEVL, INITDS, XERMSG

  !* REVISION HISTORY  (YYMMDD)
  !   770701  DATE WRITTEN
  !   890531  Changed all specific intrinsics to generic.  (WRB)
  !   890531  REVISION DATE from Version 3.2
  !   891214  Prologue converted to Version 4.0 format.  (BAB)
  !   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
  !   900720  Routine changed from user-callable to subsidiary.  (WRB)
  !   920618  Removed space from variable names.  (RWC, WRB)
  USE service, ONLY : D1MACH
  REAL(DP), INTENT(IN) :: X
  REAL(DP), INTENT(OUT) :: Ampl, Theta
  REAL(DP) :: z
  INTEGER, PARAMETER :: nbm0 = 15, nbt02 = 16, nbm02 = 13, nbth0 = 14
  REAL(DP), PARAMETER :: eta = 0.1_DP*D1MACH(3), xmax = 1._DP/D1MACH(4)
  REAL(DP), PARAMETER :: bm0cs(37) = [ +.9211656246827742712573767730182E-1_DP, &
    -.1050590997271905102480716371755E-2_DP, +.1470159840768759754056392850952E-4_DP, &
    -.5058557606038554223347929327702E-6_DP, +.2787254538632444176630356137881E-7_DP, &
    -.2062363611780914802618841018973E-8_DP, +.1870214313138879675138172596261E-9_DP, &
    -.1969330971135636200241730777825E-10_DP, +.2325973793999275444012508818052E-11_DP, &
    -.3009520344938250272851224734482E-12_DP, +.4194521333850669181471206768646E-13_DP, &
    -.6219449312188445825973267429564E-14_DP, +.9718260411336068469601765885269E-15_DP, &
    -.1588478585701075207366635966937E-15_DP, +.2700072193671308890086217324458E-16_DP, &
    -.4750092365234008992477504786773E-17_DP, +.8615128162604370873191703746560E-18_DP, &
    -.1605608686956144815745602703359E-18_DP, +.3066513987314482975188539801599E-19_DP, &
    -.5987764223193956430696505617066E-20_DP, +.1192971253748248306489069841066E-20_DP, &
    -.2420969142044805489484682581333E-21_DP, +.4996751760510616453371002879999E-22_DP, &
    -.1047493639351158510095040511999E-22_DP, +.2227786843797468101048183466666E-23_DP, &
    -.4801813239398162862370542933333E-24_DP, +.1047962723470959956476996266666E-24_DP, &
    -.2313858165678615325101260800000E-25_DP, +.5164823088462674211635199999999E-26_DP, &
    -.1164691191850065389525401599999E-26_DP, +.2651788486043319282958336000000E-27_DP, &
    -.6092559503825728497691306666666E-28_DP, +.1411804686144259308038826666666E-28_DP, &
    -.3298094961231737245750613333333E-29_DP, +.7763931143074065031714133333333E-30_DP, &
    -.1841031343661458478421333333333E-30_DP, +.4395880138594310737100799999999E-31_DP ]
  REAL(DP), PARAMETER :: bth0cs(44) = [ -.24901780862128936717709793789967E+0_DP, &
    +.48550299609623749241048615535485E-3_DP, -.54511837345017204950656273563505E-5_DP, &
    +.13558673059405964054377445929903E-6_DP, -.55691398902227626227583218414920E-8_DP, &
    +.32609031824994335304004205719468E-9_DP, -.24918807862461341125237903877993E-10_DP, &
    +.23449377420882520554352413564891E-11_DP, -.26096534444310387762177574766136E-12_DP, &
    +.33353140420097395105869955014923E-13_DP, -.47890000440572684646750770557409E-14_DP, &
    +.75956178436192215972642568545248E-15_DP, -.13131556016891440382773397487633E-15_DP, &
    +.24483618345240857495426820738355E-16_DP, -.48805729810618777683256761918331E-17_DP, &
    +.10327285029786316149223756361204E-17_DP, -.23057633815057217157004744527025E-18_DP, &
    +.54044443001892693993017108483765E-19_DP, -.13240695194366572724155032882385E-19_DP, &
    +.33780795621371970203424792124722E-20_DP, -.89457629157111779003026926292299E-21_DP, &
    +.24519906889219317090899908651405E-21_DP, -.69388422876866318680139933157657E-22_DP, &
    +.20228278714890138392946303337791E-22_DP, -.60628500002335483105794195371764E-23_DP, &
    +.18649748964037635381823788396270E-23_DP, -.58783732384849894560245036530867E-24_DP, &
    +.18958591447999563485531179503513E-24_DP, -.62481979372258858959291620728565E-25_DP, &
    +.21017901684551024686638633529074E-25_DP, -.72084300935209253690813933992446E-26_DP, &
    +.25181363892474240867156405976746E-26_DP, -.89518042258785778806143945953643E-27_DP, &
    +.32357237479762298533256235868587E-27_DP, -.11883010519855353657047144113796E-27_DP, &
    +.44306286907358104820579231941731E-28_DP, -.16761009648834829495792010135681E-28_DP, &
    +.64292946921207466972532393966088E-29_DP, -.24992261166978652421207213682763E-29_DP, &
    +.98399794299521955672828260355318E-30_DP, -.39220375242408016397989131626158E-30_DP, &
    +.15818107030056522138590618845692E-30_DP, -.64525506144890715944344098365426E-31_DP, &
    +.26611111369199356137177018346367E-31_DP ]
  REAL(DP), PARAMETER :: bm02cs(40) = [ +.9500415145228381369330861335560E-1_DP, &
    -.3801864682365670991748081566851E-3_DP, +.2258339301031481192951829927224E-5_DP, &
    -.3895725802372228764730621412605E-7_DP, +.1246886416512081697930990529725E-8_DP, &
    -.6065949022102503779803835058387E-10_DP, +.4008461651421746991015275971045E-11_DP, &
    -.3350998183398094218467298794574E-12_DP, +.3377119716517417367063264341996E-13_DP, &
    -.3964585901635012700569356295823E-14_DP, +.5286111503883857217387939744735E-15_DP, &
    -.7852519083450852313654640243493E-16_DP, +.1280300573386682201011634073449E-16_DP, &
    -.2263996296391429776287099244884E-17_DP, +.4300496929656790388646410290477E-18_DP, &
    -.8705749805132587079747535451455E-19_DP, +.1865862713962095141181442772050E-19_DP, &
    -.4210482486093065457345086972301E-20_DP, +.9956676964228400991581627417842E-21_DP, &
    -.2457357442805313359605921478547E-21_DP, +.6307692160762031568087353707059E-22_DP, &
    -.1678773691440740142693331172388E-22_DP, +.4620259064673904433770878136087E-23_DP, &
    -.1311782266860308732237693402496E-23_DP, +.3834087564116302827747922440276E-24_DP, &
    -.1151459324077741271072613293576E-24_DP, +.3547210007523338523076971345213E-25_DP, &
    -.1119218385815004646264355942176E-25_DP, +.3611879427629837831698404994257E-26_DP, &
    -.1190687765913333150092641762463E-26_DP, +.4005094059403968131802476449536E-27_DP, &
    -.1373169422452212390595193916017E-27_DP, +.4794199088742531585996491526437E-28_DP, &
    -.1702965627624109584006994476452E-28_DP, +.6149512428936330071503575161324E-29_DP, &
    -.2255766896581828349944300237242E-29_DP, +.8399707509294299486061658353200E-30_DP, &
    -.3172997595562602355567423936152E-30_DP, +.1215205298881298554583333026514E-30_DP, &
    -.4715852749754438693013210568045E-31_DP ]
  REAL(DP), PARAMETER :: bt02cs(39) = [ -.24548295213424597462050467249324E+0_DP, &
    +.12544121039084615780785331778299E-2_DP, -.31253950414871522854973446709571E-4_DP, &
    +.14709778249940831164453426969314E-5_DP, -.99543488937950033643468850351158E-7_DP, &
    +.85493166733203041247578711397751E-8_DP, -.86989759526554334557985512179192E-9_DP, &
    +.10052099533559791084540101082153E-9_DP, -.12828230601708892903483623685544E-10_DP, &
    +.17731700781805131705655750451023E-11_DP, -.26174574569485577488636284180925E-12_DP, &
    +.40828351389972059621966481221103E-13_DP, -.66751668239742720054606749554261E-14_DP, &
    +.11365761393071629448392469549951E-14_DP, -.20051189620647160250559266412117E-15_DP, &
    +.36497978794766269635720591464106E-16_DP, -.68309637564582303169355843788800E-17_DP, &
    +.13107583145670756620057104267946E-17_DP, -.25723363101850607778757130649599E-18_DP, &
    +.51521657441863959925267780949333E-19_DP, -.10513017563758802637940741461333E-19_DP, &
    +.21820381991194813847301084501333E-20_DP, -.46004701210362160577225905493333E-21_DP, &
    +.98407006925466818520953651199999E-22_DP, -.21334038035728375844735986346666E-22_DP, &
    +.46831036423973365296066286933333E-23_DP, -.10400213691985747236513382399999E-23_DP, &
    +.23349105677301510051777740800000E-24_DP, -.52956825323318615788049749333333E-25_DP, &
    +.12126341952959756829196287999999E-25_DP, -.28018897082289428760275626666666E-26_DP, &
    +.65292678987012873342593706666666E-27_DP, -.15337980061873346427835733333333E-27_DP, &
    +.36305884306364536682359466666666E-28_DP, -.86560755713629122479172266666666E-29_DP, &
    +.20779909972536284571238399999999E-29_DP, -.50211170221417221674325333333333E-30_DP, &
    +.12208360279441714184191999999999E-30_DP, -.29860056267039913454250666666666E-31_DP ]
  REAL(DP), PARAMETER ::  pi4 = 0.785398163397448309615660845819876_DP
  !* FIRST EXECUTABLE STATEMENT  D9B0MP
  ! nbm0 = INITDS(bm0cs,eta)
  ! nbt02 = INITDS(bt02cs,eta)
  ! nbm02 = INITDS(bm02cs,eta)
  ! nbth0 = INITDS(bth0cs,eta)
  !
  IF( X<4._DP ) THEN
    ERROR STOP 'D9B0MP : X MUST BE >= 4'
  ELSEIF( X<=8._DP ) THEN
    z = (128._DP/(X*X)-5._DP)/3._DP
    Ampl = (.75_DP+DCSEVL(z,bm0cs(1:nbm0)))/SQRT(X)
    Theta = X - pi4 + DCSEVL(z,bt02cs(1:nbt02))/X
  ELSEIF( X<=xmax ) THEN
    z = 128._DP/(X*X) - 1._DP
    Ampl = (.75_DP+DCSEVL(z,bm02cs(1:nbm02)))/SQRT(X)
    Theta = X - pi4 + DCSEVL(z,bth0cs(1:nbth0))/X
  ELSE
    ERROR STOP 'D9B0MP : NO PRECISION BECAUSE X IS BIG'
  END IF

  RETURN
END SUBROUTINE D9B0MP